<div class="kc-section kc-section--going-in-reverse" style="margin-bottom: 0;">
  <h1 class="kc-section-title">Going in Reverse</h1>
  
  <!-- Difficulty + Location -->
  <div class="kc-objective-meta kc-objective-meta--stacked">
    <div class="kc-meta-line kc-difficulty">
      <span class="kc-meta-label">Difficulty:</span>
      <span class="kc-difficulty-scale"
            aria-label="Difficulty 1 out of 5 snowflakes">
        <i class="fas fa-snowflake kc-snowflake kc-snowflake-active"></i>
        <i class="fas fa-snowflake kc-snowflake kc-snowflake-active"></i>
        <i class="fas fa-snowflake kc-snowflake"></i>
        <i class="fas fa-snowflake kc-snowflake"></i>
        <i class="fas fa-snowflake kc-snowflake"></i>
      </span>
    </div>

    <div class="kc-meta-line kc-location">
      <span class="kc-meta-label">Location:</span>
      <span class="kc-meta-value">Retro Store</span>
    </div>
  </div>

  <!-- Objective line -->
  <p class="kc-objective-summary kc-meta-line">
    <span class="kc-meta-label">Objective:</span>
    <span class="kc-meta-value">
      Kevin in the Retro Store needs help rewinding tech and going in reverse. Extract the flag and enter it here.
    </span>
  </p>

  <!-- Conversation banner -->
  <div class="kc-convo-header">
    <span class="kc-convo-icon">
      <i class="fas fa-comment-dots" aria-hidden="true"></i>
    </span>
    <span class="kc-convo-title">Kevin McFarland Conversation:</span>
  </div>

  <div class="kc-objective-detail kc-objective-detail--no-panel">
    <div class="kc-convo-bubble">
      <div class="kc-convo-avatar">
        <img src="kevinmcfarland-avatar.gif"
             alt="Kevin McFarland avatar">
        <div class="kc-convo-name">Kevin McFarland</div>
      </div>

      <div class="kc-convo-text">
        <p>
          Hello, I'm Kevin (though past friends have referred to me as 'Heavy K'). If you ever hear any one say that philosophy is a useless college degree, don't believe them; it's not. I've arrived where I am at because of it. It just made the path more interesting.
        </p>
        <p>
          I have more hobbies than I can keep up with, including Amateur Astronomy, Shortwave Radio, and retro-gaming. Things like backyard observances of distant galaxies, non-internet involved, around the world communications, and those who program for the Atari 2600 still invoke degrees of awe for me.
        </p>
        <p>
          One of the most influential books I've read is "Godel, Escher, and Bach" by Douglas Hofstadter. I'm also a bit of a Tolkien fanatic.
        </p>
        <p>
          My wife and my daughter are everything; without them, I surely would still be kicking rusty tin cans down the lonely highways of my past.
        </p>
        <p>
          You know, there's something beautifully nostalgic about stumbling across old computing artifacts. Just last week, I was sorting through some boxes in my garage and came across a collection of 5.25" floppies from my college days - mostly containing terrible attempts at programming assignments and a few games I'd copied from friends.
        </p>
        <p>
          Finding an old Commodore 64 disk with a mysterious BASIC program on it? That's like discovering a digital time capsule. The C64 was an incredible machine for its time - 64KB of RAM seemed like an ocean of possibility back then. I spent countless hours as a kid typing in program listings from Compute! magazine, usually making at least a dozen typos along the way.
        </p>
        <p>
          The thing about BASIC programs from that era is they were often written by clever programmers who knew how to hide things in plain sight. Sometimes the most interesting discoveries come from reading the code itself rather than watching it execute. It's like being a digital archaeologist - you're not just looking at what the program does, you're understanding how the programmer thought.
        </p>
        <p>
          Take your time with this one. Those old-school programmers had to be creative within such tight constraints. You'll know the flag by the Christmas phrase that pays.
        </p>

        <div class="kc-convo-actions">
          <button class="kc-convo-play-btn" type="button"
                  data-npc-audio="going-in-reverse">
            <i class="fas fa-play" aria-hidden="true"></i>
            <span>Play Audio</span>
          </button>
        </div>
      </div> <!-- /.kc-convo-text -->
    </div>   <!-- /.kc-convo-bubble -->
  </div>     <!-- /.kc-objective-detail -->

  <!-- Hints header -->
  <div class="kc-convo-header kc-hints-header">
    <span class="kc-convo-icon kc-hints-icon">
      <i class="fas fa-lightbulb" aria-hidden="true"></i>
    </span>
    <span class="kc-convo-title">Hints:</span>
  </div>

<!-- Hint 1 -->
<div class="kc-hint-card">
  <div class="kc-hint-title">Going in Reverse</div>
  <div class="kc-hint-meta">From: Santa</div>
  <div class="kc-hint-meta">Objective: Going in Reverse</div>
  <p>
    Holy cow! Another retro floppy disk, what are the odds? Well it looks like this one is intact.
  </p>
</div>

<!-- Hint 2 -->
<div class="kc-hint-card">
  <div class="kc-hint-title">Going in Reverse</div>
  <div class="kc-hint-meta">From: Santa</div>
  <div class="kc-hint-meta">Objective: Going in Reverse</div>
  <p>
    Maybe it is encrypted OR encoded?
  </p>
</div>

<!-- Hint 3 -->
<div class="kc-hint-card">
  <div class="kc-hint-title">Going in Reverse</div>
  <div class="kc-hint-meta">From: Santa</div>
  <div class="kc-hint-meta">Objective: Going in Reverse</div>
  <p>
    It looks like the program on the disk contains some weird coding.
  </p>
</div>

<!-- Item header -->
<div class="kc-convo-header kc-item-header">
  <span class="kc-convo-icon kc-item-icon">
    <i class="fas fa-box-open" aria-hidden="true"></i>
  </span>
  <span class="kc-convo-title">Item</span>
</div>

<div class="kc-item-bubble">
  <!-- Clickable floppy icon -->
  <a href="login.bas" download class="kc-item-thumb-link">
    <img src="basic.png" alt="C64 icon" class="kc-item-thumb">
  </a>

  <div class="kc-item-body">
    <!-- Clickable filename -->
    <a href="login.bas" download class="kc-item-title-link">
      <span class="kc-item-title">Just a BASIC Program</span>
    </a>
    <p class="kc-item-desc">
      You‚Äôve stumbled upon an old Commodore 64 floppy disk containing a mysterious
      <!-- Clickable ‚Äúfloppy disk image‚Äù text -->
      <a href="login.bas" download class="kc-item-inline-link">
        BASIC program.
      </a>
    </p>
  </div>
</div>

<!-- NEW purple banner goes *after* the bubble -->
<div class="kc-workflow-header">
<span class="kc-workflow-icon">
    <i class="fas fa-tasks" aria-hidden="true"></i>
</span>
<span class="kc-workflow-title">Working through the Challenge:</span>
</div>

<div class="kc-note-bubble">
  <span class="kc-note-label">Write-up notes</span>
  <p>
  Open the BASIC program <code>"login.bas"</code> in a text editor.
  </p>
</div> 

<div class="kc-code-window kc-code-window--autoheight">
  <div class="kc-code-header">
    <i class="fas fa-code" aria-hidden="true"></i>
    <span>login.bas (Commodore 64 BASIC)</span>
  </div>

  <pre class="kc-code-block"><code class="language-basic">10 REM *** COMMODORE 64 SECURITY SYSTEM ***
20 ENC_PASS$ = "D13URKBT"
30 ENC_FLAG$ = "DSA|auhts*wkfi=dhjwubtthut+dhhkfis+hnkz" <span class="token comment kc-basic-inline-comment">' old "DSA|qnisf`bX_huXariz"</span>
40 INPUT "ENTER PASSWORD: "; PASS$
50 IF LEN(PASS$) <> LEN(ENC_PASS$) THEN GOTO 90
60 FOR I = 1 TO LEN(PASS$)
70 IF CHR$(ASC(MID$(PASS$,I,1)) XOR 7) <> MID$(ENC_PASS$,I,1) THEN GOTO 90
80 NEXT I
85 FLAG$ = "" : FOR I = 1 TO LEN(ENC_FLAG$) : FLAG$ = FLAG$ + CHR$(ASC(MID$(ENC_FLAG$,I,1)) XOR 7) : NEXT I : PRINT FLAG$
90 PRINT "ACCESS DENIED"
100 END</code></pre>
</div>

<div class="kc-note-bubble">
  <span class="kc-note-label">Write-up notes</span>

  <p>
    This <strong>Commodore 64 BASIC</strong> program is doing the same trick twice:
    it ‚Äúencrypts‚Äù characters by applying an <code>XOR 7</code> operation.
  </p>

  <p>
    <strong>1) Password check (lines 50‚Äì80)</strong><br>
    The key line is:
    <code>CHR$(ASC(MID$(PASS$,I,1)) XOR 7)</code>.<br>
    That means for each character we type, the program XORs its ASCII value with
    <code>7</code>, converts it back to a character, and compares it to the stored
    <code>ENC_PASS$</code> string.
  </p>

  <p>
    XOR is reversible: <code>(x XOR 7) XOR 7 = x</code>.<br>
    So to recover the real password, we simply XOR every character in
    <code>ENC_PASS$</code> with <code>7</code>.
    Doing that yields the plaintext password:
    <code><strong>C64RULES</strong></code>.
  </p>

  <p>
    <strong>2) Flag decrypt (line 85)</strong><br>
    If the password matches, the program builds <code>FLAG$</code> by XORing every
    character in <code>ENC_FLAG$</code> with the same value (<code>7</code>) and then
    prints it. Since the same XOR key is used, we don‚Äôt even need to run BASIC ‚Äî
    we can just XOR-decrypt <code>ENC_FLAG$</code> directly.
  </p>
</div>

<div class="kc-terminal-window kc-terminal-window--wrap kc-terminal-window--kali">
  <div class="kali-titlebar">
    <span class="kali-titlebar-icon">üñ•Ô∏è</span>
    <span class="kali-title">Kali Shell</span>
    <span class="kali-titlebar-buttons">
      <span class="kali-btn kali-btn-min"></span>
      <span class="kali-btn kali-btn-max"></span>
      <span class="kali-btn kali-btn-close"></span>
    </span>
  </div>

  <pre class="kc-terminal-text"><span class="term-kali-prompt">‚îå‚îÄ‚îÄ(<span class="term-kali-user">postshell</span><span class="term-kali-symbol">„âø</span><span class="term-kali-host">postshell</span>)</span><span class="term-kali-path">-[~/HHC2025/Going_In_Reverse]</span>
<span class="term-kali-prompt">‚îî‚îÄ$</span> <span class="term-kali-command">python3 - &lt;&lt;'PY'
enc_pass = "D13URKBT"
enc_flag = "DSA|auhts*wkfi=dhjwubtthut+dhhkfis+hnkz"

def xor7(s):
    return ''.join(chr(ord(c) ^ 7) for c in s)

print("Recovered password:", xor7(enc_pass))
print("Decrypted flag:", xor7(enc_flag))
PY</span>
<span class="term-kali-output">Recovered password: C64RULES
Decrypted flag: CTF{frost-plan:compressors,coolant,oil}</span>
<span class="term-kali-prompt">‚îî‚îÄ$</span></pre>
</div>

<div class="kc-solution-header">
  <span class="kc-solution-icon">
    <i class="fas fa-check-circle" aria-hidden="true"></i>
  </span>
  <span class="kc-solution-title"><strong>SOLUTION: CTF{frost-plan:compressors,coolant,oil}</strong></span>
</div>

<!-- Solution dialogue banner -->
<div class="kc-convo-header kc-solution-dialog-header">
  <span class="kc-convo-icon">
    <i class="fas fa-comment-dots" aria-hidden="true"></i>
  </span>
  <span class="kc-convo-title">Solution dialogue:</span>
</div>

<div class="kc-objective-detail kc-objective-detail--no-panel">
  <div class="kc-convo-bubble">
    <div class="kc-convo-avatar">
      <img src="kevinmcfarland-portrait.png"
           alt="Charlie Goldner avatar">
      <div class="kc-convo-name">Charlie Goldner</div>
    </div>

    <div class="kc-convo-text">
      <p>
        Excellent work! You've just demonstrated one of the most valuable skills in cybersecurity - the ability to think like the original programmer and unravel their logic without needing to execute a single line of code.
      </p>

      <div class="kc-convo-actions">
        <button class="kc-convo-play-btn kc-convo-play-btn-complete" type="button">
          <i class="fas fa-play" aria-hidden="true"></i>
          <span>Play Audio</span>
        </button>
      </div>
    </div>
  </div>
</div>       <!-- /.kc-section -->