<div class="kc-section" style="margin-bottom: 0;">
  <h1 class="kc-section-title">Retro Recovery</h1>

  <!-- Difficulty + Location -->
  <div class="kc-objective-meta kc-objective-meta--stacked">
    <div class="kc-meta-line kc-difficulty">
      <span class="kc-meta-label">Difficulty:</span>
      <span class="kc-difficulty-scale"
            aria-label="Difficulty 1 out of 5 snowflakes">
        <i class="fas fa-snowflake kc-snowflake kc-snowflake-active"></i>
        <i class="fas fa-snowflake kc-snowflake kc-snowflake-active"></i>
        <i class="fas fa-snowflake kc-snowflake"></i>
        <i class="fas fa-snowflake kc-snowflake"></i>
        <i class="fas fa-snowflake kc-snowflake"></i>
      </span>
    </div>

    <div class="kc-meta-line kc-location">
      <span class="kc-meta-label">Location:</span>
      <span class="kc-meta-value">Retro Shop</span>
    </div>
  </div>

  <!-- Objective line -->
  <p class="kc-objective-summary kc-meta-line">
    <span class="kc-meta-label">Objective:</span>
    <span class="kc-meta-value">
      Join Mark in the retro shop. Analyze his disk image for a blast from the retro past and recover some classic treasures.
    </span>
  </p>

  <!-- Conversation banner -->
  <div class="kc-convo-header">
    <span class="kc-convo-icon">
      <i class="fas fa-comment-dots" aria-hidden="true"></i>
    </span>
    <span class="kc-convo-title">Mark DeVito Conversation:</span>
  </div>

  <div class="kc-objective-detail kc-objective-detail--no-panel">
    <div class="kc-convo-bubble">
      <div class="kc-convo-avatar">
        <img src="markdevito-avatar.gif"
             alt="Mark DeVito avatar">
        <div class="kc-convo-name">Mark DeVito</div>
      </div>

      <div class="kc-convo-text">
        <p>
          I am an avid collector of things of the past. I love old technology. I love how it connects us to the past. Some remind me of my dad, who was an engineer on the Apollo 11 mission and helped develop the rendezvous and altimeter radar on the space craft.
        </p>
        <p>
          If you ever get into collecting things like vintage computers, here is a tip. Never forget to remove the RIFA capacitors from vintage computer power supplies when restoring a system. If not they can pop and fill the room with nasty smoke.
        </p>
        <p>
          I love vintage computing, it‚Äôs the very core of where and when it all began. I still enjoy writing programs in BASIC and have started re-learning Apple II assembly language. I started writing code in 1982 on a Commodore CBM.
        </p>
        <p>
          Sometimes it is the people no one can imagine anything of who do the things no one can imagine. - Alan Turing
        </p>
        <p>
          You never forget your first 8-bit system.
        </p>
        <p>
          While Kevin and I were cleaning up the Retro Store, we found this FAT12 floppy disk image, must have been under this arcade machine for years. These disks were the heart of machines like the Commodore 64. I am so glad you can still mount them on a modern PC.
        </p>
        <p>
          When I was a kid we shared warez by hiding things as deleted files.
        </p>
        <p>
          I remember writing programs in BASIC. So much fun! My favorite was Star Trek.
        </p>
        <p>
          The beauty of file systems is that 'deleted' doesn't always mean gone forever.
        </p>
        <p>
          Ready to dive into some digital archaeology and see what secrets this old disk is hiding?
        </p>
        <p>
          Go to Items in your badge, download the floppy disk image, and see what you can find!
        </p>

        <div class="kc-convo-actions">
          <button class="kc-convo-play-btn" type="button"
                  data-npc-audio="retro-recovery">
            <i class="fas fa-play" aria-hidden="true"></i>
            <span>Play Audio</span>
          </button>
        </div>
      </div> <!-- /.kc-convo-text -->
    </div>   <!-- /.kc-convo-bubble -->
  </div>     <!-- /.kc-objective-detail -->

  <!-- Hints header -->
  <div class="kc-convo-header kc-hints-header">
    <span class="kc-convo-icon kc-hints-icon">
      <i class="fas fa-lightbulb" aria-hidden="true"></i>
    </span>
    <span class="kc-convo-title">Hints:</span>
  </div>

<!-- Hint 1 -->
<div class="kc-hint-card">
  <div class="kc-hint-title">Retro Recovery</div>
  <div class="kc-hint-meta">From: Santa</div>
  <div class="kc-hint-meta">Objective: Retro Recovery</div>
  <p>
    I know there are still tools available that can help you find deleted files. Maybe that might help. Ya know, one of my favorite games was a Quick Basic game called Star Trek.
  </p>
</div>

<!-- Hint 2 -->
<div class="kc-hint-card">
  <div class="kc-hint-title">Retro Recovery</div>
  <div class="kc-hint-meta">From: Santa</div>
  <div class="kc-hint-meta">Objective: Retro Recovery</div>
  <p>
    I miss old school games. I wonder if there is anything on this disk? I remember, when kids would accidentlly delete things.......... it wasn't to hard to recover files. I wonder if you can still mount these disks?
  </p>
</div>

<!-- Hint 3 -->
<div class="kc-hint-card">
  <div class="kc-hint-title">Retro Recovery</div>
  <div class="kc-hint-meta">From: Santa</div>
  <div class="kc-hint-meta">Objective: Retro Recovery</div>
  <p>
    Wow! A disk from the 1980s! I remember delivering those computer disks to the good boys and girls. Games were their favorite, but they weren't like they are now.
  </p>
</div>

<!-- Item header -->
<div class="kc-convo-header kc-item-header">
  <span class="kc-convo-icon kc-item-icon">
    <i class="fas fa-box-open" aria-hidden="true"></i>
  </span>
  <span class="kc-convo-title">Item</span>
</div>

<div class="kc-item-bubble">
  <!-- Clickable floppy icon -->
  <a href="floppy.img" download class="kc-item-thumb-link">
    <img src="floppy.png" alt="Floppy disk icon" class="kc-item-thumb">
  </a>

  <div class="kc-item-body">
    <!-- Clickable filename -->
    <a href="floppy.img" download class="kc-item-title-link">
      <span class="kc-item-title">floppy.img</span>
    </a>
    <p class="kc-item-desc">
      You got yourself a
      <!-- Clickable ‚Äúfloppy disk image‚Äù text -->
      <a href="floppy.img" download class="kc-item-inline-link">
        floppy disk image
      </a>
      from an old IBM PC! Retro!!!!
    </p>
  </div>
</div>

<!-- NEW purple banner goes *after* the bubble -->
<div class="kc-workflow-header">
<span class="kc-workflow-icon">
    <i class="fas fa-tasks" aria-hidden="true"></i>
</span>
<span class="kc-workflow-title">Working through the Challenge:</span>
</div>

<!-- NEW purple banner goes *after* the bubble -->
<div class="kc-note-bubble">
  <span class="kc-note-label">Write-up notes</span>
  <p>
    Click the floppy disk to grab yourself a copy of the disk image. After downloading¬†<code>floppy.img</code>, we first want to confirm what type of disk image it is.
  </p>
  <p>
    On our Kali box we used the <code>file</code> command against
    the image:
    <code>file floppy.img</code>. This tells us it‚Äôs a DOS/MBR boot sector using a
    small FAT12 filesystem ‚Äî exactly what we‚Äôd expect from an old IBM PC floppy.
  </p>
</div> 

<div class="kc-terminal-window kc-terminal-window--wrap kc-terminal-window--kali">
  <div class="kali-titlebar">
    <span class="kali-titlebar-icon">üñ•Ô∏è</span>
    <span class="kali-title">Kali Shell</span>
    <span class="kali-titlebar-buttons">
      <span class="kali-btn kali-btn-min"></span>
      <span class="kali-btn kali-btn-max"></span>
      <span class="kali-btn kali-btn-close"></span>
    </span>
  </div>

  <pre class="kc-terminal-text"><span class="term-kali-prompt">
‚îå‚îÄ‚îÄ(<span class="term-kali-user">postshell</span><span class="term-kali-symbol">„âø</span><span class="term-kali-host">postshell</span>)</span><span class="term-kali-path">-[~/HHC2025/Retro_Recovery]</span>
<span class="term-kali-prompt">‚îî‚îÄ$</span> <span class="term-kali-command">file floppy.img</span>
<span class="term-kali-output">floppy.img: DOS/MBR boot sector, code offset 0x3c+2, OEM-ID "mkfs.fat", root entries 224,
sectors 2880 (volumes &lt;=32 MB), sectors/FAT 9, sectors/track 18, reserved 0x1,
serial number 0x9c01e8ae, unlabeled, FAT (12 bit), followed by FAT
</span></pre>
</div>

<div class="kc-note-bubble">
  <span class="kc-note-label">Write-up notes</span>
  <p>
    Next, we wanted to see what files (including deleted ones) were on the
    floppy image. We used <code>fls</code> from The Sleuth Kit with the
    filesystem type set to FAT12 (from the earlier <code>file</code> command)
    and enabled recursive listing:
    <code>fls -f fat12 -r floppy.img</code>. This lists directories, regular
    files, and even deleted entries.
  </p>
</div>

<div class="kc-terminal-window kc-terminal-window--wrap kc-terminal-window--kali">
  <div class="kali-titlebar">
    <span class="kali-titlebar-icon">üñ•Ô∏è</span>
    <span class="kali-title">Kali Shell</span>
    <span class="kali-titlebar-buttons">
      <span class="kali-btn kali-btn-min"></span>
      <span class="kali-btn kali-btn-max"></span>
      <span class="kali-btn kali-btn-close"></span>
    </span>
  </div>

  <pre class="kc-terminal-text"><span class="term-kali-prompt">
‚îå‚îÄ‚îÄ(<span class="term-kali-user">postshell</span><span class="term-kali-symbol">„âø</span><span class="term-kali-host">postshell</span>)</span><span class="term-kali-path">-[~/HHC2025/Retro_Recovery]</span>
<span class="term-kali-prompt">‚îî‚îÄ$</span> <span class="term-kali-command">fls -f fat12 -r floppy.img</span>
<span class="term-kali-output">d/d 4:  .fseventsd
+ r/r 231:      fseventsd-uuid
r/r * 6:        all_i-want_fo
d/d 8:  qb45
+ r/r 1189:     BC.EXE
+ r/r 1190:     BRUN45.EXE
+ r/r 1191:     LIB.EXE
+ r/r 1192:     LINK.EXE
+ r/r 1193:     MOUSE.COM
+ r/r 1196:     PACKING.LST.txt
+ r/r 1197:     QB.EXE
+ r/r 1198:     QB.INI
r/r * 10:       .all_i-want_f
v/v 45779:      $MBR
v/v 45780:      $FAT1
v/v 45781:      $FAT2
V/V 45782:      $OrphanFiles
</span></pre>
</div>

<div class="kc-note-bubble">
  <span class="kc-note-label">Write-up notes</span>
  <p>
    The <code>fls</code> output contains some especially interesting lines:
    entries marked with an asterisk (like <code>r/r * 6: all_i-want_fo</code>)
    indicate <strong>deleted</strong> files that may still be recoverable.
    To carve out the contents of that deleted file, We need to use Sleuth Kit‚Äôs
    <code>icat</code> with the filesystem type set to FAT12 and targeted inode
    <code>6</code>:
    <code>icat -f fat12 floppy.img 6 &gt; recovered_6.bin</code>.
    Afterward, a quick <code>ls</code> confirms that the recovered file was
    written to disk.
  </p>
</div>

<div class="kc-terminal-window kc-terminal-window--wrap kc-terminal-window--kali">
  <div class="kali-titlebar">
    <span class="kali-titlebar-icon">üñ•Ô∏è</span>
    <span class="kali-title">Kali Shell</span>
    <span class="kali-titlebar-buttons">
      <span class="kali-btn kali-btn-min"></span>
      <span class="kali-btn kali-btn-max"></span>
      <span class="kali-btn kali-btn-close"></span>
    </span>
  </div>
  <pre class="kc-terminal-text"><span class="term-kali-prompt">
‚îå‚îÄ‚îÄ(<span class="term-kali-user">postshell</span><span class="term-kali-symbol">„âø</span><span class="term-kali-host">postshell</span>)</span><span class="term-kali-path">-[~/HHC2025/Retro_Recovery]</span>
<span class="term-kali-prompt">‚îî‚îÄ$</span> <span class="term-kali-command">icat -f fat12 floppy.img 6 &gt; recovered_6.bin</span>

<span class="term-kali-prompt">‚îå‚îÄ‚îÄ(<span class="term-kali-user">postshell</span><span class="term-kali-symbol">„âø</span><span class="term-kali-host">postshell</span>)</span><span class="term-kali-path">-[~/HHC2025/Retro_Recovery]</span>
<span class="term-kali-prompt">‚îî‚îÄ$</span> <span class="term-kali-command">ls</span>
<span class="term-kali-output">floppy.img  recovered_6.bin
</span></pre>
</div>

<div class="kc-note-bubble">
  <span class="kc-note-label">Write-up notes</span>
  <p>
    With the recovered file in hand, the next step is to quickly inspect its
    contents. To avoid dumping the entire file (in case there was binary data),
    use <code>sed</code> to print just the first 40 lines:
    <code>sed -n '1,40p' recovered_6.bin</code>. This gives a safe peek at the
    start of the recovered BASIC source.
  </p>
</div>

<div class="kc-terminal-window kc-terminal-window--wrap kc-terminal-window--kali">
  <div class="kali-titlebar">
    <span class="kali-titlebar-icon">üñ•Ô∏è</span>
    <span class="kali-title">Kali Shell</span>
    <span class="kali-titlebar-buttons">
      <span class="kali-btn kali-btn-min"></span>
      <span class="kali-btn kali-btn-max"></span>
      <span class="kali-btn kali-btn-close"></span>
    </span>
  </div>

  <pre class="kc-terminal-text"><span class="term-kali-prompt">
‚îå‚îÄ‚îÄ(<span class="term-kali-user">postshell</span><span class="term-kali-symbol">„âø</span><span class="term-kali-host">postshell</span>)</span><span class="term-kali-path">-[~/HHC2025/Retro_Recovery]</span>
<span class="term-kali-prompt">‚îî‚îÄ$</span> <span class="term-kali-command">sed -n '1,40p' recovered_6.bin</span>
<span class="term-kali-output">1 REM original file superstartrek.bas dated 2/13/2009 from bcg.tar.gz
2 REM QBasic conversion by WTN...
3 REM 2/16/2021 - uncrunched, changed B9=2 to B9=0, added RANDOMIZE and SLEEP
4 REM incorporated instructions from superstartrekins.bas
5 REM 2/19/2021 - changed the code after DO YOU NEED INSTRUCTIONS?
10 REM SUPER STARTREK - MAY 16,1978 - REQUIRES 24K MEMORY
30 REM
40 REM ****        **** STAR TREK ****        ****
50 REM **** SIMULATION OF A MISSION OF THE STARSHIP ENTERPRISE,
60 REM **** AS SEEN ON THE STAR TREK TV SHOW.
70 REM **** ORIGIONAL PROGRAM BY MIKE MAYFIELD, MODIFIED VERSION
80 REM **** PUBLISHED IN DEC'S "101 BASIC GAMES", BY DAVE AHL.
90 REM **** MODIFICATIONS TO THE LATTER (PLUS DEBUGGING) BY BOB
100 REM *** LEEDOM - APRIL &amp; DECEMBER 1974,
110 REM *** WITH A LITTLE HELP FROM HIS FRIENDS . . .
120 REM *** COMMENTS, EPITHETS, AND SUGGESTIONS SOLICITED --
130 REM *** SEND TO:  R. C. LEEDOM
140 REM ***           WESTINGHOUSE DEFENSE &amp; ELECTRONICS SYSTEMS CNTR.
150 REM ***           BOX 746, M.S. 338
160 REM ***           BALTIMORE, MD  21203
170 REM ***
180 REM *** CONVERTED TO MICROSOFT 8 K BASIC 3/16/78 BY JOHN GORDERS
190 REM *** LINE NUMBERS FROM VERSION STREK7 OF 1/12/75 PRESERVED AS
200 REM *** MUCH AS POSSIBLE WHILE USING MULTIPLE STATEMENTS PER LINE
205 REM *** SOME LINES ARE LONGER THAN 72 CHARACTERS; THIS WAS DONE
210 REM *** BY USING "?" INSTEAD OF "PRINT" WHEN ENTERING LINES
211 REM bWVycnkgY2hyaXN0bWFzIHRvIGFsbCBhbmQgdG8gYWxsIGEgZ29vZCBuaWdodAo=
215 REM ***
219 GOSUB 20000:REM instructions
220 PRINT:PRINT:PRINT:PRINT:PRINT:PRINT:PRINT:PRINT:PRINT:PRINT:PRINT
221 PRINT"                                    ,------*------,"
222 PRINT"                    ,-------------   '---  ------'"
223 PRINT"                     '-------- --'      / /"
224 PRINT"                         ,---' '-------/ /--,"
225 PRINT"                          '----------------'":PRINT
226 PRINT"                    THE USS ENTERPRISE --- NCC-1701"
227 PRINT:PRINT:PRINT:PRINT:PRINT
250 RANDOMIZE(TIMER):SLEEP 3
260 REM CLEAR 600
270 Z$="                         "
</span></pre>
</div>

<div class="kc-note-bubble">
  <span class="kc-note-label">Write-up notes</span>
  <p>
    On line <code>211</code>, there‚Äôs a suspicious
    Base64-looking string embedded in a <code>REM</code> comment:
    <code>bWVycnkgY2hyaXN0bWFzIHRvIGFsbCBhbmQgdG8gYWxsIGEgZ29vZCBuaWdodAo=</code>.
    To see what it hides, we pipe it into <code>base64 -d</code>:
    <code>echo 'bWVycnkgY2hyaXN0bWFzIHRvIGFsbCBhbmQgdG8gYWxsIGEgZ29vZCBuaWdodAo=' | base64 -d</code>.
  </p>
</div>

<div class="kc-terminal-window kc-terminal-window--wrap kc-terminal-window--kali">
  <div class="kali-titlebar">
    <span class="kali-titlebar-icon">üñ•Ô∏è</span>
    <span class="kali-title">Kali Shell</span>
    <span class="kali-titlebar-buttons">
      <span class="kali-btn kali-btn-min"></span>
      <span class="kali-btn kali-btn-max"></span>
      <span class="kali-btn kali-btn-close"></span>
    </span>
  </div>

  <pre class="kc-terminal-text"><span class="term-kali-prompt">
‚îå‚îÄ‚îÄ(<span class="term-kali-user">postshell</span><span class="term-kali-symbol">„âø</span><span class="term-kali-host">postshell</span>)</span><span class="term-kali-path">-[~/HHC2025/Retro_Recovery]</span>
<span class="term-kali-prompt">‚îî‚îÄ$</span> <span class="term-kali-command">echo 'bWVycnkgY2hyaXN0bWFzIHRvIGFsbCBhbmQgdG8gYWxsIGEgZ29vZCBuaWdodAo=' | base64 -d</span>
<span class="term-kali-output">merry christmas to all and to all a good night</span></pre>
</div>

<div class="kc-solution-header">
  <span class="kc-solution-icon">
    <i class="fas fa-check-circle" aria-hidden="true"></i>
  </span>
  <span class="kc-solution-title"><strong>SOLUTION: merry christmas to all and to all a good night</strong></span>
</div>

<!-- Solution dialogue banner -->
<div class="kc-convo-header kc-solution-dialog-header">
  <span class="kc-convo-icon">
    <i class="fas fa-comment-dots" aria-hidden="true"></i>
  </span>
  <span class="kc-convo-title">Solution dialogue:</span>
</div>

<div class="kc-objective-detail kc-objective-detail--no-panel">
  <div class="kc-convo-bubble">
    <div class="kc-convo-avatar">
      <img src="markdevito-portrait.png"
           alt="Mark avatar">
      <div class="kc-convo-name">Mark DeVito</div>
    </div>

    <div class="kc-convo-text">
      <p>
        Excellent work! You've successfully recovered that deleted file and decoded the hidden message.
      </p>
      <p>
        Sometimes the old ways are the best ways. Vintage file systems never truly forget what they've seen. Play some Star Trek... it actually works.
      </p>

      <div class="kc-convo-actions">
        <button class="kc-convo-play-btn kc-convo-play-btn-complete" type="button">
          <i class="fas fa-play" aria-hidden="true"></i>
          <span>Play Audio</span>
        </button>
      </div>
    </div>
  </div>

<div class="kc-extra-header">
  <span class="kc-extra-icon">
    <i class="fas fa-star" aria-hidden="true"></i>
  </span>
  <span class="kc-extra-title">Extra:</span>
</div>

<div class="kc-extra-bubble">
  <span class="kc-extra-label">Extra: Run the recovered Star Trek game</span>

  <p>
    If you want to actually <strong>play</strong> the recovered QBasic Star Trek game,
    the steps below recreate the workflow I used: recover the deleted BASIC file, copy the
    QB45 tools off the floppy image, and run everything inside <code>dosbox</code>.
  </p>

  <pre><code>cd /home/postshell/HHC2025/Retro_Recovery

# (optional) bulk recovery; useful to try, but it did NOT include qb45 for me
mkdir -p extracted
tsk_recover -f fat12 floppy.img extracted

# recover the deleted Star Trek BASIC file (inode 6)
icat -f fat12 floppy.img 6 &gt; recovered_6.bin

# mount the FAT12 floppy image (read-only) to access non-deleted files like qb45
sudo mkdir -p /mnt/floppy
sudo mount -o loop,ro floppy.img /mnt/floppy

# copy QB45 tools out and stage a DOSBox play folder
mkdir -p ~/dos/trek
cp -r /mnt/floppy/qb45 ~/dos/trek/QB45
sudo umount /mnt/floppy

# copy the recovered BASIC program into the DOSBox folder
cp recovered_6.bin ~/dos/trek/SUPERSTAR.BAS

# verify files are staged
ls -l ~/dos/trek ~/dos/trek/QB45 | head

# install and run DOSBox
sudo apt install -y dosbox
dosbox</code></pre>

  <p><strong>Once inside DOSBox</strong>, mount the folder and launch QuickBASIC:</p>

  <pre><code>mount c /home/postshell/dos/trek
c:
dir
cd QB45
QB.EXE</code></pre>

  <p><strong>In QuickBASIC</strong>:</p>
  <ol>
    <li><strong>File ‚Üí Open</strong></li>
    <li>Select <code>C:\SUPERSTAR.BAS</code></li>
    <li>Press <strong>F5</strong> to run</li>
  </ol>

  <p>
    That should launch the retro Star Trek game inside QuickBASIC.
  </p>
</div>

<div class="kc-extra-subtitle">Star Trek in DOSBox</div>

<div class="kc-extra-gallery">
  <a class="kc-extra-shot" href="StarTrek1.png" target="_blank" rel="noopener noreferrer">
    <img src="StarTrek1.png" alt="SUPER STAR TREK title screen in DOSBox">
  </a>

  <a class="kc-extra-shot" href="StarTrek2.png" target="_blank" rel="noopener noreferrer">
    <img src="StarTrek2.png" alt="SUPER STAR TREK mission screen in DOSBox">
  </a>

  <a class="kc-extra-shot" href="StarTrek3.png" target="_blank" rel="noopener noreferrer">
    <img src="StarTrek3.png" alt="USS Enterprise ASCII art in DOSBox">
  </a>
</div>

</div>       <!-- /.kc-section -->