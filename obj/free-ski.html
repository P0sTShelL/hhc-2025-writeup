<div class="kc-section kc--section-free-ski" style="margin-bottom: 0;">
  <h1 class="kc-section-title">Free Ski</h1>
  
  <!-- Difficulty + Location -->
  <div class="kc-objective-meta kc-objective-meta--stacked">
    <div class="kc-meta-line kc-difficulty">
      <span class="kc-meta-label">Difficulty:</span>
      <span class="kc-difficulty-scale"
            aria-label="Difficulty 1 out of 5 snowflakes">
        <i class="fas fa-snowflake kc-snowflake kc-snowflake-active"></i>
        <i class="fas fa-snowflake kc-snowflake kc-snowflake-active"></i>
        <i class="fas fa-snowflake kc-snowflake kc-snowflake-active"></i>
        <i class="fas fa-snowflake kc-snowflake kc-snowflake-active"></i>
        <i class="fas fa-snowflake kc-snowflake kc-snowflake-active"></i>
      </span>
    </div>

    <div class="kc-meta-line kc-location">
      <span class="kc-meta-label">Location:</span>
      <span class="kc-meta-value">Retro Store</span>
    </div>
  </div>

  <!-- Objective line -->
  <p class="kc-objective-summary kc-meta-line">
    <span class="kc-meta-label">Objective:</span>
    <span class="kc-meta-value">
      Go to the retro store and help Goose Olivia ski down the mountain and collect all five treasure chests to reveal the hidden flag in this classic SkiFree-inspired challenge.
    </span>
  </p>

  <!-- Conversation banner -->
  <div class="kc-convo-header">
    <span class="kc-convo-icon">
      <i class="fas fa-comment-dots" aria-hidden="true"></i>
    </span>
    <span class="kc-convo-title">Olivia Conversation:</span>
  </div>

  <div class="kc-objective-detail kc-objective-detail--no-panel">
    <div class="kc-convo-bubble">
      <div class="kc-convo-avatar">
        <img src="goose-space.png"
             alt="Olivia avatar">
        <div class="kc-convo-name">Olivia</div>
      </div>

      <div class="kc-convo-text">
        <p>
          "HONK! Well hello there! Fancy meeting you here in the Dosis Neighborhood.
        </p>
        <p>
          You know, it's the strangest thing... I used to just waddle around the Geese Islands going 'BONK' all day long. Random noises, no thoughts, just vibes. But then something changed, and now here I am‚Äîspeaking, thinking, wondering how I even got here!
        </p>
        <p>
          HONK! You know what happens to geese in a permanent winter? We can't migrate! And trust me, being stuck in one place forever isn't natural‚Äîeven for someone who just discovered they can think and talk. Frosty needs to chill out... wait, that's exactly the problem!
        </p>
        <p>
          This game looks simple enough, doesn't it? Almost too simple. But between you and me... it seems nearly impossible to win fair and square.
        </p>
        <p>
          My advice? If you ain't cheatin', you ain't tryin'. wink
        </p>
        <p>
          Now get out there and show that mountain who's boss!
        </p>      

        <div class="kc-convo-actions">
          <button class="kc-convo-play-btn" type="button"
                  data-npc-audio="free-ski">
            <i class="fas fa-play" aria-hidden="true"></i>
            <span>Play Audio</span>
          </button>
        </div>
      </div> <!-- /.kc-convo-text -->
    </div>   <!-- /.kc-convo-bubble -->
  </div>     <!-- /.kc-objective-detail -->

  <!-- Hints header -->
  <div class="kc-convo-header kc-hints-header">
    <span class="kc-convo-icon kc-hints-icon">
      <i class="fas fa-lightbulb" aria-hidden="true"></i>
    </span>
    <span class="kc-convo-title">Hints:</span>
  </div>

<!-- Hint 1 -->
<div class="kc-hint-card">
  <div class="kc-hint-title">Extraction</div>
  <div class="kc-hint-meta">From: Santa</div>
  <div class="kc-hint-meta">Objective: Free Ski</div>
    <p>
        Have you ever used <a class="kc-link-terminal" href="https://github.com/extremecoders-re/pyinstxtractor" target="_blank" rel="noopener noreferrer">PyInstaller Extractor</a>?
    </p>
</div>

<!-- Hint 2 -->
<div class="kc-hint-card">
  <div class="kc-hint-title">Decompilation!</div>
  <div class="kc-hint-meta">From: Santa</div>
  <div class="kc-hint-meta">Objective: Free Ski</div>
    <p>
        Many Python decompilers don't understand Python 3.13, but <a class="kc-link-terminal" href="https://github.com/zrax/pycdc" target="_blank" rel="noopener noreferrer">Decompyle++</a> does!
    </p>
</div>

<!-- Item header -->
<div class="kc-convo-header kc-item-header">
  <span class="kc-convo-icon kc-item-icon">
    <i class="fas fa-box-open" aria-hidden="true"></i>
  </span>
  <span class="kc-convo-title">Item</span>
</div>

<div class="kc-item-bubble">
  <!-- Clickable floppy icon -->
  <a href="FreeSki.exe" download class="kc-item-thumb-link">
    <img src="freeski.png" alt="Freeski icon" class="kc-item-thumb">
  </a>

  <div class="kc-item-body">
    <!-- Clickable filename -->
    <a href="FreeSki.exe" download class="kc-item-title-link">
      <span class="kc-item-title">Free Ski EXE</span>
    </a>
    <p class="kc-item-desc">
      A PyInstaller-compiled
      <!-- Clickable ‚Äúfloppy disk image‚Äù text -->
      <a href="FreeSki.exe" download class="kc-item-inline-link">
      executable
      </a>
      containing a SkiFree-inspired skiing game with hidden treasure chests and flag mechanics.
    </p>
  </div>
</div>

<!-- Write-up bubble -->
<div class="kc-note-bubble">
  <span class="kc-note-label">Write-up notes</span>

  <p>
    To get started, click on <strong>Free Ski</strong> above to grab a copy of the game.
    Then download the recommended extraction tool and unpack <code>FreeSki.exe</code>.
  </p>
</div>

<!-- Kali shell -->
<div class="kc-terminal-window kc-terminal-window--wrap kc-terminal-window--kali">
  <div class="kali-titlebar">
    <span class="kali-titlebar-icon">üñ•Ô∏è</span>
    <span class="kali-title">Kali Shell</span>
    <span class="kali-titlebar-buttons">
      <span class="kali-btn kali-btn-min"></span>
      <span class="kali-btn kali-btn-max"></span>
      <span class="kali-btn kali-btn-close"></span>
    </span>
  </div>

<pre class="kc-terminal-text"><span class="term-kali-prompt">‚îå‚îÄ‚îÄ(<span class="term-kali-user">postshell</span><span class="term-kali-symbol">„âø</span><span class="term-kali-host">postshell</span>)</span><span class="term-kali-path">-[~/HHC2025/FreeSKI]</span>
<span class="term-kali-prompt">‚îî‚îÄ$</span> <span class="term-kali-command"># 1) Grab the extractor</span>
<span class="term-kali-command">git clone https://github.com/extremecoders-re/pyinstxtractor</span>
<span class="term-kali-output">Cloning into 'pyinstxtractor'...</span>
<span class="term-kali-output">remote: Enumerating objects: 217, done.</span>
<span class="term-kali-output">remote: Counting objects: 100% (93/93), done.</span>
<span class="term-kali-output">remote: Compressing objects: 100% (44/44), done.</span>
<span class="term-kali-output">remote: Total 217 (delta 61), reused 49 (delta 49), pack-reused 124 (from 3)</span>
<span class="term-kali-output">Receiving objects: 100% (217/217), 77.04 KiB | 2.14 MiB/s, done.</span>
<span class="term-kali-output">Resolving deltas: 100% (103/103), done.</span>

<span class="term-kali-prompt">‚îå‚îÄ‚îÄ(<span class="term-kali-user">postshell</span><span class="term-kali-symbol">„âø</span><span class="term-kali-host">postshell</span>)</span><span class="term-kali-path">-[~/HHC2025/FreeSKI]</span>
<span class="term-kali-prompt">‚îî‚îÄ$</span> <span class="term-kali-command">ls</span>
<span class="term-kali-output">FreeSki.exe  pyinstxtractor</span>

<span class="term-kali-prompt">‚îå‚îÄ‚îÄ(<span class="term-kali-user">postshell</span><span class="term-kali-symbol">„âø</span><span class="term-kali-host">postshell</span>)</span><span class="term-kali-path">-[~/HHC2025/FreeSKI/pyinstxtractor]</span>
<span class="term-kali-prompt">‚îî‚îÄ$</span> <span class="term-kali-command">python pyinstxtractor.py ../FreeSki.exe</span>
<span class="term-kali-output">[+] Processing ../FreeSki.exe</span>
<span class="term-kali-output">[+] Pyinstaller version: 2.1+</span>
<span class="term-kali-output">[+] Python version: 3.13</span>
<span class="term-kali-output">[+] Length of package: 16806404 bytes</span>
<span class="term-kali-output">[+] Found 98 files in CArchive</span>
<span class="term-kali-output">[+] Beginning extraction...please standby</span>
<span class="term-kali-output">[+] Possible entry point: pyiboot01_bootstrap.pyc</span>
<span class="term-kali-output">[+] Possible entry point: pyi_rth_inspect.pyc</span>
<span class="term-kali-output">[+] Possible entry point: pyi_rth_pkgres.pyc</span>
<span class="term-kali-output">[+] Possible entry point: pyi_rth_setuptools.pyc</span>
<span class="term-kali-output">[+] Possible entry point: pyi_rth_multiprocessing.pyc</span>
<span class="term-kali-output">[+] Possible entry point: pyi_rth_pkgutil.pyc</span>
<span class="term-kali-output">[+] Possible entry point: FreeSki.pyc</span>
<span class="term-kali-output">[+] Found 471 files in PYZ archive</span>
<span class="term-kali-output">[!] Error: Failed to decompress PYZ.pyz_extracted/jaraco.pyc, probably encrypted. Extracting as is.</span>
<span class="term-kali-output">[!] Error: Failed to decompress PYZ.pyz_extracted/setuptools/_distutils/compilers.pyc, probably encrypted. Extracting as is.</span>
<span class="term-kali-output">[!] Error: Failed to decompress PYZ.pyz_extracted/setuptools/_distutils/compilers/C.pyc, probably encrypted. Extracting as is.</span>
<span class="term-kali-output">[!] Error: Failed to decompress PYZ.pyz_extracted/setuptools/_vendor.pyc, probably encrypted. Extracting as is.</span>
<span class="term-kali-output">[!] Error: Failed to decompress PYZ.pyz_extracted/setuptools/_vendor/jaraco.pyc, probably encrypted. Extracting as is.</span>
<span class="term-kali-output">[+] Successfully extracted pyinstaller archive: ../FreeSki.exe</span>
<span class="term-kali-output"></span>
<span class="term-kali-output">You can now use a python decompiler on the pyc files within the extracted directory</span>

<span class="term-kali-prompt">‚îå‚îÄ‚îÄ(<span class="term-kali-user">postshell</span><span class="term-kali-symbol">„âø</span><span class="term-kali-host">postshell</span>)</span><span class="term-kali-path">-[~/HHC2025/FreeSKI/pyinstxtractor]</span>
<span class="term-kali-prompt">‚îî‚îÄ$</span> </pre>
</div>

<!-- Write-up bubble -->
<div class="kc-note-bubble">
  <span class="kc-note-label">Write-up notes</span>

  <p>
    Taking an initial look at the extracted PyInstaller bundle, we move into the
    <code>FreeSki.exe_extracted</code> directory to inventory what was unpacked.
  </p>
</div>

<!-- Kali shell -->
<div class="kc-terminal-window kc-terminal-window--wrap kc-terminal-window--kali">
  <div class="kali-titlebar">
    <span class="kali-titlebar-icon">üñ•Ô∏è</span>
    <span class="kali-title">Kali Shell</span>
    <span class="kali-titlebar-buttons">
      <span class="kali-btn kali-btn-min"></span>
      <span class="kali-btn kali-btn-max"></span>
      <span class="kali-btn kali-btn-close"></span>
    </span>
  </div>

  <pre class="kc-terminal-text"><span class="term-kali-prompt">‚îå‚îÄ‚îÄ(<span class="term-kali-user">postshell</span><span class="term-kali-symbol">„âø</span><span class="term-kali-host">postshell</span>)</span><span class="term-kali-path">-[~/HHC2025/FreeSKI/pyinstxtractor]</span>
<span class="term-kali-prompt">‚îî‚îÄ$</span> <span class="term-kali-command">cd FreeSki.exe_extracted</span>

<span class="term-kali-prompt">‚îå‚îÄ‚îÄ(<span class="term-kali-user">postshell</span><span class="term-kali-symbol">„âø</span><span class="term-kali-host">postshell</span>)</span><span class="term-kali-path">-[~/HHC2025/FreeSKI/pyinstxtractor/FreeSki.exe_extracted]</span>
<span class="term-kali-prompt">‚îî‚îÄ$</span> <span class="term-kali-command">ls</span>
<span class="term-kali-output">_asyncio.pyd      libmodplug-1.dll      portmidi.dll                 pyi_rth_pkgutil.pyc     <span class="term-blue">setuptools</span></span>
<span class="term-kali-output"><span class="term-red">base_library.zip</span>  libogg-0.dll          pyexpat.pyd                  pyi_rth_setuptools.pyc  _socket.pyd</span>
<span class="term-kali-output">_bz2.pyd          libopus-0.dll         <span class="term-blue">pygame</span>                       python313.dll           _ssl.pyd</span>
<span class="term-kali-output">_ctypes.pyd       libopusfile-0.dll     pyiboot01_bootstrap.pyc      PYZ.pyz                 struct.pyc</span>
<span class="term-kali-output">_decimal.pyd      libpng16-16.dll       pyimod01_archive.pyc         <span class="term-blue">PYZ.pyz_extracted</span>       unicodedata.pyd</span>
<span class="term-kali-output">FreeSki.pyc       libssl-3.dll          pyimod02_importers.pyc       _queue.pyd              VCRUNTIME140_1.dll</span>
<span class="term-kali-output">freetype.dll      libtiff-5.dll         pyimod03_ctypes.pyc          SDL2.dll                VCRUNTIME140.dll</span>
<span class="term-kali-output">_hashlib.pyd      libwebp-7.dll         pyimod04_pywin32.pyc         SDL2_image.dll          _wmi.pyd</span>
<span class="term-kali-output">libcrypto-3.dll   _lzma.pyd             pyi_rth_inspect.pyc          SDL2_mixer.dll          zlib1.dll</span>
<span class="term-kali-output">libffi-8.dll      _multiprocessing.pyd  pyi_rth_multiprocessing.pyc  SDL2_ttf.dll</span>
<span class="term-kali-output">libjpeg-9.dll     _overlapped.pyd       pyi_rth_pkgres.pyc           select.pyd</span>

<span class="term-kali-prompt">‚îå‚îÄ‚îÄ(<span class="term-kali-user">postshell</span><span class="term-kali-symbol">„âø</span><span class="term-kali-host">postshell</span>)</span><span class="term-kali-path">-[~/HHC2025/FreeSKI/pyinstxtractor/FreeSki.exe_extracted]</span>
<span class="term-kali-prompt">‚îî‚îÄ$</span> </pre>
</div>

<!-- Write-up bubble -->
<div class="kc-note-bubble">
  <span class="kc-note-label">Write-up notes</span>

  <p>
    Looking at the extracted contents, <code>FreeSki.pyc</code> stands out as the likely main game logic.
    To inspect it, we can grab the recommended decompiler (<code>pycdc</code>) and build it on Kali, then
    attempt to decompile the bytecode.
  </p>
</div>

<!-- Kali shell -->
<div class="kc-terminal-window kc-terminal-window--wrap kc-terminal-window--kali">
  <div class="kali-titlebar">
    <span class="kali-titlebar-icon">üñ•Ô∏è</span>
    <span class="kali-title">Kali Shell</span>
    <span class="kali-titlebar-buttons">
      <span class="kali-btn kali-btn-min"></span>
      <span class="kali-btn kali-btn-max"></span>
      <span class="kali-btn kali-btn-close"></span>
    </span>
  </div>

  <pre class="kc-terminal-text"><span class="term-kali-prompt">‚îå‚îÄ‚îÄ(<span class="term-kali-user">postshell</span><span class="term-kali-symbol">„âø</span><span class="term-kali-host">postshell</span>)</span><span class="term-kali-path">-[~/HHC2025/FreeSKI]</span>
<span class="term-kali-prompt">‚îî‚îÄ$</span> <span class="term-kali-command">git clone https://github.com/zrax/pycdc</span>
<span class="term-kali-output">Cloning into 'pycdc'...</span>
<span class="term-kali-output">remote: Enumerating objects: 3023, done.</span>
<span class="term-kali-output">remote: Total 3023 (delta 0), reused 0 (delta 0), pack-reused 3023 (from 1)</span>
<span class="term-kali-output">Receiving objects: 100% (3023/3023), 944.25 KiB | 5.65 MiB/s, done.</span>
<span class="term-kali-output">Resolving deltas: 100% (1903/1903), done.</span>

<span class="term-kali-prompt">‚îå‚îÄ‚îÄ(<span class="term-kali-user">postshell</span><span class="term-kali-symbol">„âø</span><span class="term-kali-host">postshell</span>)</span><span class="term-kali-path">-[~/HHC2025/FreeSKI]</span>
<span class="term-kali-prompt">‚îî‚îÄ$</span> <span class="term-kali-command">cd pycdc</span>

<span class="term-kali-prompt">‚îå‚îÄ‚îÄ(<span class="term-kali-user">postshell</span><span class="term-kali-symbol">„âø</span><span class="term-kali-host">postshell</span>)</span><span class="term-kali-path">-[~/HHC2025/FreeSKI/pycdc/build]</span>
<span class="term-kali-prompt">‚îî‚îÄ$</span> <span class="term-kali-command">cmake ..</span>
<span class="term-kali-output">-- The C compiler identification is GNU 15.2.0</span>
<span class="term-kali-output">-- The CXX compiler identification is GNU 15.2.0</span>
<span class="term-kali-output">-- Detecting C compiler ABI info</span>
<span class="term-kali-output">-- Detecting C compiler ABI info - done</span>
<span class="term-kali-output">-- Check for working C compiler: /usr/bin/cc - skipped</span>
<span class="term-kali-output">---- Truncated output ---------</span>
<span class="term-kali-output">-- Build files have been written to: /home/postshell/HHC2025/FreeSKI/pycdc/build</span>

<span class="term-kali-prompt">‚îå‚îÄ‚îÄ(<span class="term-kali-user">postshell</span><span class="term-kali-symbol">„âø</span><span class="term-kali-host">postshell</span>)</span><span class="term-kali-path">-[~/HHC2025/FreeSKI/pycdc/build]</span>
<span class="term-kali-prompt">‚îî‚îÄ$</span> <span class="term-kali-command">make -j"$(nproc)"</span>
<span class="term-kali-output">[  2%] Building CXX object CMakeFiles/pycxx.dir/bytecode.cpp.o</span>
<span class="term-kali-output">[  4%] Building CXX object CMakeFiles/pycxx.dir/data.cpp.o</span>
<span class="term-kali-output">[  6%] Building CXX object CMakeFiles/pycxx.dir/pyc_code.cpp.o</span>
<span class="term-kali-output">[  9%] Building CXX object CMakeFiles/pycxx.dir/pyc_module.cpp.o</span>
<span class="term-kali-output">[ 11%] Building CXX object CMakeFiles/pycxx.dir/pyc_numeric.cpp.o</span>
<span class="term-kali-output">------ Truncated output ----------</span>
<span class="term-kali-output">[ 95%] Built target pycdas</span>
<span class="term-kali-output">[ 97%] Building CXX object CMakeFiles/pycdc.dir/ASTNode.cpp.o</span>
<span class="term-kali-output">[100%] Linking CXX executable pycdc</span>
<span class="term-kali-output">[100%] Built target pycdc</span>

<span class="term-kali-prompt">‚îå‚îÄ‚îÄ(<span class="term-kali-user">postshell</span><span class="term-kali-symbol">„âø</span><span class="term-kali-host">postshell</span>)</span><span class="term-kali-path">-[~/HHC2025/FreeSKI/pycdc/build]</span>
<span class="term-kali-prompt">‚îî‚îÄ$</span> <span class="term-kali-command">./pycdc ../../pyinstxtractor/FreeSki.exe_extracted/FreeSki.pyc &gt; ../../../FreeSKI/FreeSki_decompiled.py</span>
<span class="term-kali-output">Unsupported opcode: MAKE_FUNCTION (122)</span>
</pre>
</div>

<!-- Write-up bubble -->
<div class="kc-note-bubble">
  <span class="kc-note-label">Write-up notes</span>

  <p>
    It looks like the version of <code>pycdc</code> we built doesn‚Äôt fully support Python 3.13 bytecode yet
    (the decompile attempt hit an unsupported opcode). Instead of fighting the decompiler, we'll pivot to
    disassembly using <code>pycdas</code> so we can still recover the program logic from the bytecode.
  </p>
</div>

<!-- Kali shell -->
<div class="kc-terminal-window kc-terminal-window--wrap kc-terminal-window--kali">
  <div class="kali-titlebar">
    <span class="kali-titlebar-icon">üñ•Ô∏è</span>
    <span class="kali-title">Kali Shell</span>
    <span class="kali-titlebar-buttons">
      <span class="kali-btn kali-btn-min"></span>
      <span class="kali-btn kali-btn-max"></span>
      <span class="kali-btn kali-btn-close"></span>
    </span>
  </div>

  <pre class="kc-terminal-text"><span class="term-kali-prompt">‚îå‚îÄ‚îÄ(<span class="term-kali-user">postshell</span><span class="term-kali-symbol">„âø</span><span class="term-kali-host">postshell</span>)</span><span class="term-kali-path">-[~/HHC2025/FreeSKI/pycdc/build]</span>
<span class="term-kali-prompt">‚îî‚îÄ$</span> <span class="term-kali-command">./pycdas ../../pyinstxtractor/FreeSki.exe_extracted/FreeSki.pyc &gt; ../../../FreeSKI/FreeSki.das</span>

<span class="term-kali-prompt">‚îå‚îÄ‚îÄ(<span class="term-kali-user">postshell</span><span class="term-kali-symbol">„âø</span><span class="term-kali-host">postshell</span>)</span><span class="term-kali-path">-[~/HHC2025/FreeSKI/pycdc/build]</span>
<span class="term-kali-prompt">‚îî‚îÄ$</span> <span class="term-kali-command">cd ../../../FreeSKI</span>

<span class="term-kali-prompt">‚îå‚îÄ‚îÄ(<span class="term-kali-user">postshell</span><span class="term-kali-symbol">„âø</span><span class="term-kali-host">postshell</span>)</span><span class="term-kali-path">-[~/HHC2025/FreeSKI]</span>
<span class="term-kali-prompt">‚îî‚îÄ$</span> <span class="term-kali-command">cat FreeSki.das</span>
<span class="term-kali-output">FreeSki.pyc (Python 3.13)</span>
<span class="term-kali-output">[Code]</span>
<span class="term-kali-output">    File Name: FreeSki.py</span>
<span class="term-kali-output">    Object Name: &lt;module&gt;</span>
<span class="term-kali-output">    Qualified Name: &lt;module&gt;</span>
<span class="term-kali-output">    Arg Count: 0</span>
<span class="term-kali-output">    Pos Only Arg Count: 0</span>
<span class="term-kali-output">    KW Only Arg Count: 0</span>
<span class="term-kali-output">    Stack Size: 13</span>
<span class="term-kali-output">    Flags: 0x00000000</span>
<span class="term-kali-output">    [Names]</span>
<span class="term-kali-output">        'pygame'</span>
<span class="term-kali-output">        'enum'</span>
<span class="term-kali-output">        'random'</span>
<span class="term-kali-output">        'binascii'</span>
<span class="term-kali-output">        'init'</span>
<span class="term-kali-output">        'font'</span>
<span class="term-kali-output">        'screen_width'</span>
<span class="term-kali-output">        'screen_height'</span>
<span class="term-kali-output">        'framerate_fps'</span>
<span class="term-kali-output">        'object_horizonal_hitbox'</span>
<span class="term-kali-output">        'object_vertical_hitbox'</span>
<span class="term-kali-output">        'max_speed'</span>
<span class="term-kali-output">------ Truncated output ---------</span>
<span class="term-kali-output">        2592    LOAD_CONST                      79: 12000</span>
<span class="term-kali-output">        2594    LOAD_CONST                      80: b'n\xad\xb4l^I\xdb\xe1\xd0\x7f\x92\x92\x96\x1bq\xca`PvWg\x85\xb21^\x93F\x1a\xee'</span>
<span class="term-kali-output">        2596    CALL                            5</span>
<span class="term-kali-output">        2604    LOAD_NAME                       75: Mountain</span>
<span class="term-kali-output">        2606    PUSH_NULL</span>
<span class="term-kali-output">        2608    LOAD_CONST                      81: 'Dragonmount'</span>
<span class="term-kali-output">        2610    LOAD_CONST                      82: 16282</span>
<span class="term-kali-output">        2612    LOAD_CONST                      83: 15500</span>
<span class="term-kali-output">        2614    LOAD_CONST                      84: 16000</span>
<span class="term-kali-output">        2616    LOAD_CONST                      85: b'Z\xf9\xdf\x7f_\x02\xd8\x89\x12\xd2\x11p\xb6\x96\x19\x05x))v\xc3\xecv\xf4\xe2\\\x9a\xbe\xb5'</span>
<span class="term-kali-output">        2618    CALL                            5</span>
<span class="term-kali-output">        2626    BUILD_LIST                      7</span>
<span class="term-kali-output">        2628    STORE_GLOBAL                    76: Mountains</span>
<span class="term-kali-output">        2630    LOAD_BUILD_CLASS</span>
<span class="term-kali-output">        2632    PUSH_NULL</span>
<span class="term-kali-output">        2634    LOAD_CONST                      86: &lt;CODE&gt; ObstacleSet</span>
<span class="term-kali-output">        2636    MAKE_FUNCTION</span>
<span class="term-kali-output">        2638    LOAD_CONST                      87: 'ObstacleSet'</span>
<span class="term-kali-output">        2640    LOAD_NAME                       77: list</span>
<span class="term-kali-output">        2642    CALL                            3</span>
<span class="term-kali-output">        2650    STORE_NAME                      78: ObstacleSet</span>
<span class="term-kali-output">        2652    LOAD_CONST                      88: &lt;CODE&gt; SetFlag</span>
<span class="term-kali-output">        2654    MAKE_FUNCTION</span>
<span class="term-kali-output">        2656    STORE_NAME                      79: SetFlag</span>
<span class="term-kali-output">        2658    LOAD_CONST                      89: &lt;CODE&gt; main</span>
<span class="term-kali-output">        2660    MAKE_FUNCTION</span>
<span class="term-kali-output">        2662    STORE_NAME                      80: main</span>
<span class="term-kali-output">        2664    LOAD_NAME                       81: __name__</span>
<span class="term-kali-output">        2666    LOAD_CONST                      90: '__main__'</span>
<span class="term-kali-output">        2668    COMPARE_OP                      88 (==)</span>
<span class="term-kali-output">        2672    POP_JUMP_IF_FALSE               8 (to 2690)</span>
<span class="term-kali-output">        2676    LOAD_NAME                       80: main</span>
<span class="term-kali-output">        2678    PUSH_NULL</span>
<span class="term-kali-output">        2680    CALL                            0</span>
<span class="term-kali-output">        2688    POP_TOP</span>
<span class="term-kali-output">        2690    RETURN_CONST                    1: None</span>
<span class="term-kali-output">        2692    RETURN_CONST                    1: None</span>
<span class="term-kali-output">    [Exception Table]</span>
</pre>
</div>

<!-- Write-up bubble -->
<div class="kc-note-bubble">
  <span class="kc-note-label">Write-up notes</span>

  <p>
    The disassembly already exposes some high-value breadcrumbs (symbol names, treasure logic, mountain parameters,
    and what looks like a stream/XOR-style decode). We could solve this directly from <code>.das</code>, but it‚Äôs
    much easier to reason about the win condition from a clean decompile.
  </p>

    <p>
    After trying a few decompilers that struggled with Python 3.13 bytecode, I ended up using
    <a class="kc-link-note" href="https://pychaos.io" target="_blank" rel="noopener">pychaos.io</a>, which produced a readable
    reconstruction of <code>FreeSki.py</code>.
    </p>
</div>

<!-- Python script (outside the bubble) -->
<div class="kc-code-window kc-code-window--py">
  <div class="kc-code-titlebar">
    <span class="kc-code-icon">&gt;_</span>
    <span class="kc-code-title">FreeSki.py (decompiled)</span>

    <!-- Copy button -->
    <button
      class="kc-code-copy-btn kc-code-copy"
      type="button"
      data-copy-target="#freeski-py"
      aria-label="Copy FreeSki.py"
      title="Copy"
    >
      <i class="fas fa-copy" aria-hidden="true"></i>
      <span>Copy</span>
    </button>
  </div>

  <!-- Page-local sizing only for this code block -->
  <style>
    .kc-code-window--py .kc-code-block--taller { max-height: 820px; }
    .kc-code-window--py code[class*="language-"] { font-size: 0.90em; }
  </style>

  <pre class="kc-code-block kc-code-block--taller kc-no-wheel"><code id="freeski-py" class="language-python">global mountain_width
global grace_period
global flag_text_surface
global Mountains
import pygame
import enum
import random
import binascii
pygame.init()
pygame.font.init()
screen_width = 800
screen_height = 600
framerate_fps = 60
object_horizonal_hitbox = 1.5
object_vertical_hitbox = 0.5
max_speed = 0.4
accelerate_increment = 0.02
decelerate_increment = 0.05
scale_factor = 0.1
pixels_per_meter = 30
skier_vertical_pixel_location = 100
mountain_width = 1000
obstacle_draw_distance = 23
skier_start = 5
grace_period = 10
screen = pygame.display.set_mode((screen_width,screen_height))
clock = pygame.time.Clock()
dt = 0
pygame.key.set_repeat(500,100)
pygame.display.set_caption('FreeSki v0.0')
skierimage = pygame.transform.scale_by(pygame.image.load('img/skier.png'),scale_factor)
skier_leftimage = pygame.transform.scale_by(pygame.image.load('img/skier_left.png'),scale_factor)
skier_rightimage = pygame.transform.scale_by(pygame.image.load('img/skier_right.png'),scale_factor)
skier_crashimage = pygame.transform.scale_by(pygame.image.load('img/skier_crash.png'),scale_factor)
skier_pizzaimage = pygame.transform.scale_by(pygame.image.load('img/skier_pizza.png'),scale_factor)
treeimage = pygame.transform.scale_by(pygame.image.load('img/tree.png'),scale_factor)
yetiimage = pygame.transform.scale_by(pygame.image.load('img/yeti.png'),scale_factor)
treasureimage = pygame.transform.scale_by(pygame.image.load('img/treasure.png'),scale_factor)
boulderimage = pygame.transform.scale_by(pygame.image.load('img/boulder.png'),scale_factor)
victoryimage = pygame.transform.scale_by(pygame.image.load('img/victory.png'),0.7)
gamefont = pygame.font.Font('fonts/VT323-Regular.ttf',24)
text_surface1 = gamefont.render('Use arrow keys to ski and find the 5 treasures!',False,pygame.Color('blue'))
text_surface2 = gamefont.render('          find all the lost bears. don\\'t drill into a rock. Win game.',False,pygame.Color('yellow'))
flagfont = pygame.font.Font('fonts/VT323-Regular.ttf',32)
flag_text_surface = flagfont.render('replace me',False,pygame.Color('saddle brown'))
flag_message_text_surface1 = flagfont.render('You win! Drill Baby is reunited with',False,pygame.Color('yellow'))
flag_message_text_surface2 = flagfont.render('all its bears. Welcome to Flare-On 12.',False,pygame.Color('yellow'))

class SkierStates(enum.Enum):
  CRUISING = enum.auto()
  ACCELERATING = enum.auto()
  DECELERATING = enum.auto()
  TURNING_LEFT = enum.auto()
  TURNING_RIGHT = enum.auto()
  CRASHED = enum.auto()

SkierStateImages = {SkierStates.CRUISING:skierimage,SkierStates.ACCELERATING:skierimage,SkierStates.DECELERATING:skier_pizzaimage,SkierStates.TURNING_LEFT:skier_leftimage,SkierStates.TURNING_RIGHT:skier_rightimage,SkierStates.CRASHED:skier_crashimage}

class Skier:
  def __init__(self,x,y):
    '''X and Y denote the pixel coordinates of the bottom center of the skier image'''
    self.state = SkierStates.CRUISING
    self.elevation = 0
    self.horizonal_location = 0
    self.speed = 0
    self.x = x
    self.y = y
    imagerect = skierimage.get_rect()
    self.rect = pygame.Rect(self.x-imagerect.left/2,self.y-imagerect.height,0,0)

  def Draw(self,surface):
    surface.blit(SkierStateImages[self.state],self.rect)

  def TurnLeft(self):
    self.StateChange(SkierStates.TURNING_LEFT)

  def TurnRight(self):
    self.StateChange(SkierStates.TURNING_RIGHT)

  def SlowDown(self):
    self.speed -= decelerate_increment
    if self.speed &lt; 0:
      self.speed = 0
    self.StateChange(SkierStates.DECELERATING)

  def SpeedUp(self):
    self.speed += accelerate_increment
    if self.speed &gt; max_speed:
      self.speed = max_speed
    self.StateChange(SkierStates.ACCELERATING)

  def Cruise(self):
    self.StateChange(SkierStates.CRUISING)

  def StateChange(self,newstate):
    if self.state != SkierStates.CRASHED:
      self.state = newstate
      return None
    else:
      return None

  def UpdateLocation(self):
    '''update elevation and horizonal location based on one frame of the current speed and turning status
speed will be split between down and to the turning side with simplified math to avoid calculating
square roots'''
    if self.state == SkierStates.TURNING_LEFT:
      self.elevation -= self.speed*0.7
      self.horizonal_location -= self.speed*0.7
    else:
      if self.state == SkierStates.TURNING_RIGHT:
        self.elevation -= self.speed*0.7
        self.horizonal_location += self.speed*0.7
      else:
        self.elevation -= self.speed
    if self.elevation &lt; 0:
      self.elevation = 0
      return None
    else:
      return None

  def isMoving(self):
    if self.speed != 0:
      return True
    else:
      return False

  def Crash(self):
    self.StateChange(SkierStates.CRASHED)
    self.speed = 0

  def Reset(self):
    self.state = SkierStates.CRUISING
    self.speed = 0
    self.elevation = 0
    self.horizonal_location = 0

  def isReadyForReset(self):
    if self.state == SkierStates.CRASHED or self.elevation == 0:
      return True
    else:
      return False

class Obstacles(enum.Enum):
  BOULDER = enum.auto()
  TREE = enum.auto()
  YETI = enum.auto()
  TREASURE = enum.auto()

ObstacleImages = {Obstacles.BOULDER:boulderimage,Obstacles.TREE:treeimage,Obstacles.YETI:yetiimage,Obstacles.TREASURE:treasureimage}
ObstacleProbabilities = {Obstacles.BOULDER:0.005,Obstacles.TREE:0.01,Obstacles.YETI:0.005}
fakeObstacleProbabilities = {Obstacles.BOULDER:0.1,Obstacles.TREE:0.1,Obstacles.YETI:0.1}

def CalculateObstacleProbabilityRanges(probabilities):
  remaining = 1
  last_end = 0
  range_dict = {}
  for key in probabilities.keys():
    new_last_end = last_end+probabilities[key]
    range_dict[key] = (last_end,new_last_end)
    last_end = new_last_end
  return range_dict

ObstacleProbabilitiesRanges = CalculateObstacleProbabilityRanges(ObstacleProbabilities)

class Mountain:
  def __init__(self,name,height,treeline,yetiline,encoded_flag):
    self.name = name
    self.height = height
    self.treeline = treeline
    self.yetiline = yetiline
    self.encoded_flag = encoded_flag
    self.treasures = self.GetTreasureLocations()

  def GetObstacles(self,elevation):
    obstacles = [None]*mountain_width
    if elevation &gt; self.height-grace_period:
      return obstacles
    else:
      random.seed(binascii.crc32(self.name.encode('utf-8'))+elevation)
      for i in range(0,mountain_width):
        r = random.random()
        obstacle = None
        for rangekey in ObstacleProbabilitiesRanges:
          if rangekey == Obstacles.TREE and elevation &gt; self.treeline:
            continue
          if rangekey == Obstacles.YETI and elevation &gt; self.yetiline:
            continue
          probrange = ObstacleProbabilitiesRanges[rangekey]
          if r &gt;= probrange[0]:
            continue
          if r &lt;= probrange[1]:
            obstacle = rangekey
            break
        obstacles[i] = obstacle

      treasure_row = None
      for key in self.treasures.keys():
        if elevation+5 &gt;= key:
          continue
        if key &gt;= elevation-5:
          continue
        treasure_row = key
        treasure_h = self.treasures[treasure_row]
        for i in range(-5,6):
          obstacles[treasure_h+i%mountain_width] = None
        if treasure_row == int(elevation):
          obstacles[treasure_h%mountain_width] = Obstacles.TREASURE
        return obstacles

      return obstacles

  def GetTreasureLocations(self):
    locations = {}
    random.seed(binascii.crc32(self.name.encode('utf-8')))
    prev_height = self.height
    prev_horiz = 0
    for i in range(0,5):
      e_delta = random.randint(200,800)
      h_delta = random.randint(int(0-e_delta/4),int(e_delta/4))
      locations[prev_height-e_delta] = prev_horiz+h_delta
      prev_height = prev_height-e_delta
      prev_horiz = prev_horiz+h_delta
    return locations

Mountains = [
  Mountain('Mount Snow',3586,3400,2400,'\\x90'),
  Mountain('Aspen',11211,11000,10000,'U\\xd7%x\\xbfvj!\\xfe\\x9d\\xb9\\xc2\\xd1k\\x02y\\x17\\x9dK\\x98\\xf1\\x92\\x0f!\\xf1\\\\\\xa0\\x1b\\x0f'),
  Mountain('Whistler',7156,6000,6500,'\\x1cN\\x13\\x1a\\x97\\xd4\\xb2!\\xf9\\xf6\\xd4#\\xee\\xebh\\xecs.\\x08M!hr9?\\xde\\x0c\\x86\\x02'),
  Mountain('Mount Baker',10781,9000,6000,'\\xac\\xf9#\\xf4T\\xf1%h\\xbe3FI+h\\x0d\\x01V\\xee\\xc2C\\x13\\xf3\\x97ef\\xac\\xe3z\\x96'),
  Mountain('Mount Norquay',6998,6300,3000,'\\x0c\\x1c\\xad!\\xc6,\\xec0\\x0b+\"\\x9f@.\\xc8\\x13\\xadb\\x86\\xea{\\xfeS\\xe0S\\x85\\x90\\x03q'),
  Mountain('Mount Erciyes',12848,10000,12000,'n\\xad\\xb4l^I\\xdb\\xe1\\xd0\\x7f\\x92\\x92\\x96\\x1bq\\xca`PvWg\\x85\\xb21^\\x93F\\x1a\\xee'),
  Mountain('Dragonmount',16282,15500,16000,'Z\\xf9\\xdf\\x7f_\\x02\\xd8\\x89\\x12\\xd2\\x11p\\xb6\\x96\\x19\\x05x))v\\xc3\\xecv\\xf4\\xe2\\\\\\x9a\\xbe\\xb5')
]

class ObstacleSet(list):
  def __init__(self,mountain,top,max_distance):
    super().__init__([])
    self.mountain = mountain
    self.top = None
    self.max = max_distance
    self.Update(top)

  def Update(self,newtop):
    if self.top:
      if newtop &gt;= self.top:
        return None
      else:
        if self.top and self.top &gt; 0:
          while self.top &gt; newtop:
            del(self[0])
            self.top = self[0][0]

        if len(self) == 0:
          for e in range(newtop,newtop-self.max,-1):
            self.append((e,self.mountain.GetObstacles(e)))
        else:
          for e in range(self[-1][0]-1,newtop-self.max,-1):
            self.append((e,self.mountain.GetObstacles(e)))

        self.top = newtop
        return None

  def CollisionDetect(self,skier):
    for row in self:
      if row[0] &gt; skier.elevation:
        continue
      if row[0] &lt; skier.elevation-object_vertical_hitbox:
        return None
      else:
        hitrange_left = skier.horizonal_location-object_horizonal_hitbox
        hitrange_right = skier.horizonal_location+object_horizonal_hitbox
        for x in range(int(hitrange_left),int(hitrange_right)+1):
          obj_at_loc = row[1][x%mountain_width]
          if obj_at_loc != None:
            continue
          if hitrange_left &lt;= x:
            continue
          if x &lt;= hitrange_right:
            continue
          (obj_at_loc,row,x%mountain_width)
          return
        continue

def SetFlag(mountain,treasure_list):
  global flag_text_surface
  product = 0
  for treasure_val in treasure_list:
    product = product&lt;&lt;8^treasure_val
  random.seed(product)
  decoded = []
  for i in range(0,len(mountain.encoded_flag)):
    r = random.randint(0,255)
    decoded.append(chr(mountain.encoded_flag[i]^r))
  flag_text = 'Flag: %s'%''.join(decoded)
  print(flag_text)
  flag_text_surface = flagfont.render(flag_text,False,pygame.Color('saddle brown'))

def main():
  victory_mode = False
  running = True
  reset_mode = True
  while running:
    screen.fill(pygame.Color('white'))
    if reset_mode:
      player_started = False
      treasures_collected = []
      skier = Skier(screen_width/2,skier_vertical_pixel_location)
      mnt = random.choice(Mountains)
      skier.elevation = mnt.height-skier_start
      obstacles = ObstacleSet(mnt,mnt.height-skier_start,obstacle_draw_distance)
      reset_mode = False

    for event in pygame.event.get():
      if event.type == pygame.QUIT:
        running = False

      if event.type == pygame.KEYDOWN:
        if skier.isReadyForReset():
          reset_mode = True
          break
        player_started = True
        if event.key == pygame.K_w or event.key == pygame.K_UP:
          skier.SlowDown()
          continue
        if event.key == pygame.K_s or event.key == pygame.K_DOWN:
          skier.SpeedUp()
          continue
        if event.key == pygame.K_a or event.key == pygame.K_LEFT:
          skier.TurnLeft()
          continue
        if event.key == pygame.K_d or event.key == pygame.K_RIGHT:
          skier.TurnRight()
          continue
        continue

      if event.type == pygame.KEYUP:
        continue

      skier.Cruise()

    if victory_mode:
      screen.blit(victoryimage,(42,42))
      x = screen_width/2-flag_text_surface.get_width()/2
      y = screen_height/2-flag_text_surface.get_height()/2+40
      screen.blit(flag_text_surface,(x,y))
    else:
      skier.UpdateLocation()
      obstacles.Update(int(skier.elevation+skier_vertical_pixel_location/pixels_per_meter))
      if skier.isMoving():
        collided_data = obstacles.CollisionDetect(skier)
        if collided_data != None:
          collided_object,collided_row,collided_row_offset = collided_data
          if collided_object == Obstacles.TREASURE:
            collided_row[1][collided_row_offset] = None
            treasures_collected.append(collided_row[0]*mountain_width+collided_row_offset)
            if len(treasures_collected) == 5:
              SetFlag(mnt,treasures_collected)
              victory_mode = True
          else:
            skier.Crash()

      top_edge = skier.elevation+skier_vertical_pixel_location/pixels_per_meter
      left_edge = skier.horizonal_location-screen_width/2/pixels_per_meter
      right_edge = skier.horizonal_location+screen_width/2/pixels_per_meter
      right_edge += 2
      bottom_edge = skier.elevation+screen_height/pixels_per_meter
      skier_drawn = False
      for obstacle_row in obstacles:
        if __CHAOS_PY_NULL_PTR_VALUE_ERR__ &lt; obstacle_row[0]+1:
          skier.Draw(screen)

        for obstacle_x in range(int(left_edge-1),int(right_edge+1)):
          obstacle = obstacle_row[1][obstacle_x%mountain_width]
          if obstacle:
            obstacle_image = ObstacleImages[obstacle]
            x = obstacle_x*pixels_per_meter*1-left_edge*pixels_per_meter
            y = top_edge*pixels_per_meter-obstacle_row[0]*pixels_per_meter*1
            y -= obstacle_image.get_height()
            screen.blit(obstacle_image,(x,y))
            continue
            (skier_drawn or skier.elevation)
        continue
        True

      if player_started == False:
        info_text = 'Use arrow keys to ski and find the 5 treasures!'
      else:
        if skier.isReadyForReset():
          info_text = 'Aww shucks, didn\\'t make it. Press any key to try again.'
        else:
          info_text = 'Skiing %s    elevation: %.2f, horizonal: %.2f, treasures %d/5'%(mnt.name,skier.elevation,skier.horizonal_location,len(treasures_collected))

      screen.blit(gamefont.render(info_text,False,pygame.Color('blue')),(0,0))

    pygame.display.flip()
    dt = clock.tick(framerate_fps)/1000

  pygame.quit()

if __name__ == '__main__':
  main()</code></pre>
</div>

<!-- Optional: Prism refresh for lazy-loaded content -->
<script>
  window.requestAnimationFrame(() => {
    const host = document.querySelector('.kc-code-window--py');
    if (!host) return;
    if (window.Prism && Prism.highlightAllUnder) Prism.highlightAllUnder(host);
    else if (window.Prism && Prism.highlightAll) Prism.highlightAll();
  });
</script>

<!-- Write-up bubble -->
<div class="kc-note-bubble">
  <span class="kc-note-label">Write-up notes</span>

  <p>
    Reviewing the decompiled output, the game logic is straightforward to follow. I started pulling code to build a
    solver, but noticed something odd: the <strong>Mount Snow</strong> encoded flag value looked noticeably different
    than the others.
  </p>

  <p>
    I reused the recovered logic from the decompile, grabbed the exact <code>b'...'</code> constants from the
    disassembly, and added a bit of glue code to decode every mountain‚Äôs flag offline.
  </p>
</div>

<!-- Python script (outside the bubble) -->
<div class="kc-code-window kc-code-window--py">
  <div class="kc-code-titlebar">
    <span class="kc-code-icon">&gt;_</span>
    <span class="kc-code-title">decode_all_freeski_flags_from_disasm_constants.py</span>

    <!-- Copy button -->
    <button
      class="kc-code-copy-btn kc-code-copy"
      type="button"
      data-copy-target="#decode-freeski-all"
      aria-label="Copy Python script"
      title="Copy"
    >
      <i class="fas fa-copy" aria-hidden="true"></i>
      <span>Copy</span>
    </button>
  </div>

  <!-- Page-local tweaks (optional): taller + slightly smaller text for this block -->
  <style>
    .kc-code-window--py .kc-code-block--taller { max-height: 820px; }
    .kc-code-window--py code[class*="language-"] { font-size: 0.92em; }
  </style>

  <pre class="kc-code-block kc-code-block--taller kc-no-wheel"><code id="decode-freeski-all" class="language-python">#!/usr/bin/env python3
# decode_all_freeski_flags_from_disasm_constants
# Uses the exact b'...' payloads from the disassembly snippet (correct Mount Snow bytes).

import random, binascii

MOUNTAIN_WIDTH = 1000

MOUNTAINS = [
    ('Mount Snow',     3586, 3400, 2400, b'\x90\x00\x1d\xbc\x17b\xed6S"\xb0&lt;Y\xd6\xce\x169\xae\xe9|\xe2Gs\xb7\xfdy\xcf5\x98'),
    ('Aspen',         11211,11000,10000, b'U\xd7%x\xbfvj!\xfe\x9d\xb9\xc2\xd1k\x02y\x17\x9dK\x98\xf1\x92\x0f!\xf1\\\xa0\x1b\x0f'),
    ('Whistler',       7156, 6000, 6500, b'\x1cN\x13\x1a\x97\xd4\xb2!\xf9\xf6\xd4#\xee\xebh\xecs.\x08M!hr9?\xde\x0c\x86\x02'),
    ('Mount Baker',   10781, 9000, 6000, b'\xac\xf9#\xf4T\xf1%h\xbe3FI+h\r\x01V\xee\xc2C\x13\xf3\x97ef\xac\xe3z\x96'),
    ('Mount Norquay',  6998, 6300, 3000, b'\x0c\x1c\xad!\xc6,\xec0\x0b+"&quot;\x9f@.\xc8\x13\xadb\x86\xea{\xfeS\xe0S\x85\x90\x03q'),
    ('Mount Erciyes', 12848,10000,12000, b'n\xad\xb4l^I\xdb\xe1\xd0\x7f\x92\x92\x96\x1bq\xca`PvWg\x85\xb21^\x93F\x1a\xee'),
    ('Dragonmount',   16282,15500,16000, b'Z\xf9\xdf\x7f_\x02\xd8\x89\x12\xd2\x11p\xb6\x96\x19\x05x))v\xc3\xecv\xf4\xe2\\\x9a\xbe\xb5'),
]

def get_treasure_locations(name, height, n=5, mw=MOUNTAIN_WIDTH):
    random.seed(binascii.crc32(name.encode('utf-8')))
    prev_height = height
    prev_horiz = 0
    locs = []
    for _ in range(n):
        e = random.randint(200, 800)
        h = random.randint(int(0 - e/4), int(e/4))  # int(true_div) truncates toward 0
        prev_height -= e
        prev_horiz  += h
        locs.append((prev_height, prev_horiz % mw))
    return locs

def build_product(locs, mw=MOUNTAIN_WIDTH):
    product = 0
    for (row, horiz) in locs:
        product = (product &lt;&lt; 8) ^ (row * mw + horiz)
    return product

def decode_flag(enc_bytes, product):
    random.seed(product)
    return ''.join(chr(b ^ random.randint(0,255)) for b in enc_bytes)

def main():
    unique_flags = set()
    print('Decoded flags by mountain:\\n')
    for name, height, treeline, yetiline, enc in MOUNTAINS:
        locs = get_treasure_locations(name, height)
        product = build_product(locs)
        flag = decode_flag(enc, product)
        unique_flags.add(flag)
        print(f&quot;- {name:16s} height={height:5d} product={product}&quot;)
        print(f&quot;  treasures: {locs}&quot;)
        print(f&quot;  flag: {flag}\\n&quot;)
    print('Unique flags found:', len(unique_flags))
    for f in sorted(unique_flags):
        print(' -', f)

if __name__ == '__main__':
    main()</code></pre>
</div>

<!-- Optional: Prism refresh for lazy-loaded pages -->
<script>
  window.requestAnimationFrame(() => {
    const block = document.querySelector('.kc-code-window--py');
    if (window.Prism && Prism.highlightAllUnder && block) {
      Prism.highlightAllUnder(block);
    } else if (window.Prism && Prism.highlightAll) {
      Prism.highlightAll();
    }
  });
</script>

<!-- Write-up bubble -->
<div class="kc-note-bubble">
  <span class="kc-note-label">Write-up notes</span>

  <p>
    With the solver in place, we can run it locally to decode the flag for every mountain using the disassembly-derived
    constants. Interestingly, every mountain produces the same decoded flag, confirming there‚Äôs a single correct
    solution regardless of which mountain is selected during gameplay.
  </p>

  <p>
    The solver also prints the exact treasure coordinates it predicts for each mountain (based on the seeded RNG),
    which would allow a ‚Äúperfect run‚Äù route ‚Äî but since all paths resolve to the same output, the key takeaway is the
    recovered flag: <code>frosty_yet_predictably_random</code>.
  </p>
</div>

<!-- Kali terminal -->
<div class="kc-terminal-window kc-terminal-window--wrap kc-terminal-window--kali">
  <div class="kali-titlebar">
    <span class="kali-titlebar-icon">üñ•Ô∏è</span>
    <span class="kali-title">Kali Shell</span>
    <span class="kali-titlebar-buttons">
      <span class="kali-btn kali-btn-min"></span>
      <span class="kali-btn kali-btn-max"></span>
      <span class="kali-btn kali-btn-close"></span>
    </span>
  </div>

  <pre class="kc-terminal-text"><span class="term-kali-prompt">‚îå‚îÄ‚îÄ(<span class="term-kali-user">postshell</span><span class="term-kali-symbol">„âø</span><span class="term-kali-host">postshell</span>)</span><span class="term-kali-path">-[~/HHC2025/FreeSKI]</span>
<span class="term-kali-prompt">‚îî‚îÄ$</span> <span class="term-kali-command">python decode_all_freeski_flags_from_disasm_constants.py</span>
<span class="term-kali-output">Decoded flags by mountain:</span>

<span class="term-kali-output">- Mount Snow       height= 3586 product=12779169760600741</span>
<span class="term-kali-output">  treasures: [(2966, 113), (2420, 85), (1718, 188), (1094, 142), (466, 85)]</span>
<span class="term-kali-output">  flag: frosty_yet_predictably_random</span>

<span class="term-kali-output">- Aspen            height=11211 product=46563350091091105</span>
<span class="term-kali-output">  treasures: [(10865, 957), (10529, 878), (9903, 898), (9183, 939), (8621, 985)]</span>
<span class="term-kali-output">  flag: frosty_yet_predictably_random</span>

<span class="term-kali-output">- Whistler         height= 7156 product=27334109270005200</span>
<span class="term-kali-output">  treasures: [(6373, 859), (6127, 850), (5897, 881), (5610, 855), (5124, 816)]</span>
<span class="term-kali-output">  flag: frosty_yet_predictably_random</span>

<span class="term-kali-output">- Mount Baker      height=10781 product=42818556817015099</span>
<span class="term-kali-output">  treasures: [(9997, 969), (9525, 931), (9112, 997), (8523, 106), (7856, 955)]</span>
<span class="term-kali-output">  flag: frosty_yet_predictably_random</span>

<span class="term-kali-output">- Mount Norquay    height= 6998 product=28436313530650830</span>
<span class="term-kali-output">  treasures: [(6642, 933), (5901, 987), (5692, 992), (5486, 943), (5115, 854)]</span>
<span class="term-kali-output">  flag: frosty_yet_predictably_random</span>

<span class="term-kali-output">- Mount Erciyes    height=12848 product=52363039524304001</span>
<span class="term-kali-output">  treasures: [(12235, 10), (11950, 962), (11660, 978), (11412, 984), (10701, 953)]</span>
<span class="term-kali-output">  flag: frosty_yet_predictably_random</span>

<span class="term-kali-output">- Dragonmount      height=16282 product=66716992209980640</span>
<span class="term-kali-output">  treasures: [(15590, 889), (14939, 816), (14634, 807), (14339, 753), (13706, 720)]</span>
<span class="term-kali-output">  flag: frosty_yet_predictably_random</span>

<span class="term-kali-output">Unique flags found: 1</span>
<span class="term-kali-output"> - frosty_yet_predictably_random</span>
</pre>
</div>

<div class="kc-solution-header">
  <span class="kc-solution-icon">
    <i class="fas fa-check-circle" aria-hidden="true"></i>
  </span>
  <span class="kc-solution-title"><strong>SOLUTION: frosty_yet_predictably_random</strong></span>
</div>

<!-- Solution dialogue banner -->
<div class="kc-convo-header kc-solution-dialog-header">
  <span class="kc-convo-icon">
    <i class="fas fa-comment-dots" aria-hidden="true"></i>
  </span>
  <span class="kc-convo-title">Solution dialogue:</span>
</div>

<div class="kc-objective-detail kc-objective-detail--no-panel">
  <div class="kc-convo-bubble">
    <div class="kc-convo-avatar">
      <img src="goose-space.png"
           alt="Olivia avatar">
      <div class="kc-convo-name">Olivia</div>
    </div>

    <div class="kc-convo-text">
      <p>
        Looks like you found your own way down that mountain... and maybe took a few shortcuts along the way. No judgment here‚Äîsometimes the clever path IS the right path. Now I'm one step closer to figuring out my own mystery. Thanks for the company, friend!
      </p>
      <div class="kc-convo-actions">
        <button class="kc-convo-play-btn kc-convo-play-btn-complete" type="button">
          <i class="fas fa-play" aria-hidden="true"></i>
          <span>Play Audio</span>
        </button>
      </div>
    </div>
  </div>
</div>       <!-- /.kc-section -->







